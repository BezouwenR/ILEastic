  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page      1
   Command  . . . . . . . . . . . . :   CRTBNDRPG
     Issued by  . . . . . . . . . . :     NLI
   Program  . . . . . . . . . . . . :   DEMO03
     Library  . . . . . . . . . . . :     ILEASTIC
   Text 'description' . . . . . . . :   *SRCMBRTXT
   Source stream file   . . . . . . :   demo03.rpgle
     CCSID  . . . . . . . . . . . . :     500
   Text 'description' . . . . . . . :
   Last Change  . . . . . . . . . . :   10-10-18  17:04:41
   Generation severity level  . . . :   10
   Default activation group . . . . :   *YES
   Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                        *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                        *DEBUGIO   *UNREF     *NOEVENTF
   Debugging views  . . . . . . . . :   *LIST
   Debug encryption key . . . . . . :   *NONE
   Output . . . . . . . . . . . . . :   *PRINT
   Optimization level . . . . . . . :   *NONE
   Source listing indentation . . . :   *NONE
   Type conversion options  . . . . :   *NONE
   Sort sequence  . . . . . . . . . :   *HEX
   Language identifier  . . . . . . :   *JOBRUN
   Replace program  . . . . . . . . :   *YES
   User profile . . . . . . . . . . :   *USER
   Authority  . . . . . . . . . . . :   *LIBCRTAUT
   Truncate numeric . . . . . . . . :   *YES
   Fix numeric  . . . . . . . . . . :   *NONE
   Target release . . . . . . . . . :   *CURRENT
   Allow null values  . . . . . . . :   *NO
   Define condition names . . . . . :   *NONE
   Enable performance collection  . :   *PEP
   Profiling data . . . . . . . . . :   *NOCOL
   Licensed Internal Code options . :
   Generate program interface . . . :   *NO
   Include directory  . . . . . . . :   ./..
                                    :   /prj/noxdb
   Preprocessor options . . . . . . :   *NONE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page      2
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
                           S o u r c e   L i s t i n g
      1    // -----------------------------------------------------------------------------                                  000001
      2    // This example runs a simple servlet using ILEastic framework                                                    000002
      3    // Note: It requires your RPG code to be reentrant and compiled                                                   000003
      4    // for multithreading. Each client request is handled by a seperate thread.                                       000004
      5    // Start it:                                                                                                      000005
      6    // SBMJOB CMD(CALL PGM(DEMO03)) JOB(ILEASTIC3) JOBQ(QSYSNOMAX) ALWMLTTHD(*YES)                                    000006
      7    // -----------------------------------------------------------------------------                                  000007
      8    ctl-opt copyright('Sitemule.com (C), 2018');                                                                      000008
      9    ctl-opt decEdit('0,') datEdit(*YMD.) main(main);                                                                  000009
     10    ctl-opt debug(*yes) bndDir('ILEASTIC':'NOXDB');                                                                   000010
     11    ctl-opt thread(*CONCURRENT);                                                                                      000011
     12                                                                                                                      000012
     13    /include ./headers/ILEastic.rpgle                                                                                 000013
         *--------------------------------------------------------------------------------------------*
         * RPG member name  . . . . . :  ILEastic.+                                                   *                     1
         * External name  . . . . . . :  ./.././headers/ILEastic.rpgle                                *                     1
         * Last change  . . . . . . . :  10-10-18  16:13:03                                           *                     1
         *--------------------------------------------------------------------------------------------*
 Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
     14+**FREE                                                                                                              1000001
     15+                                                                                                                    1000002
     16+/if defined (ILEASTIC)                                                                                              1000003
             LINES EXCLUDED: 1
     17+/endif                                                                                                              1000005
     18+                                                                                                                    1000006
     19+/define ILEASTIC                                                                                                    1000007
     20+                                                                                                                    1000008
     21+///                                                                                                                 1000009
     22+// ILEastic - Microservices for ILE on IBM i                                                                        1000010
     23+//                                                                                                                  1000011
     24+// It is a self contained web application server for the ILE environment on                                         1000012
     25+// IBM i running microservices.                                                                                     1000013
     26+// <p>                                                                                                              1000014
     27+// ILEastic is a service program that provides a simple, blazing fast                                               1000015
     28+// programmable HTTP server for your application so you easy can plug your RPG                                      1000016
     29+// code into a services infrastructure or make simple web applications without                                      1000017
     30+// the need of any third party webserver products.                                                                  1000018
     31+//                                                                                                                  1000019
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page      3
 Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
     32+// Øauthor Niels Liisberg                                                                                           1000020
     33+// Ødate 27.08.2018                                                                                                 1000021
     34+// Øproject ILEastic                                                                                                1000022
     35+// Ølink https://github.com/sitemule/ILEastic Project page                                                          1000023
     36+///                                                                                                                 1000024
     37+                                                                                                                    1000025
     38+                                                                                                                    1000026
     39+                                                                                                                    1000027
     40+///                                                                                                                 1000028
     41+// String                                                                                                           1000029
     42+//                                                                                                                  1000030
     43+// This data structure holds a string with variable length.                                                         1000031
     44+///                                                                                                                 1000032
         *--------------------------------------------------------------------*
         * Compiler Options in Effect:                                        *
         *--------------------------------------------------------------------*
         *  Text 'description' . . . . . . . :                                *
         *  Generation severity level  . . . :   10                           *
         *  Default activation group . . . . :   *NO                          *
         *  Compiler options . . . . . . . . :   *XREF      *GEN              *
         *                                       *NOSECLVL  *SHOWCPY          *
         *                                       *EXPDDS    *EXT              *
         *                                       *NOSHOWSKP *NOSRCSTMT        *
         *                                       *DEBUGIO   *UNREF            *
         *                                       *NOEVENTF                    *
         *  Optimization level . . . . . . . :   *NONE                        *
         *  Source listing indentation . . . :   *NONE                        *
         *  Type conversion options  . . . . :   *NONE                        *
         *  Sort sequence  . . . . . . . . . :   *HEX                         *
         *  Language identifier  . . . . . . :   *JOBRUN                      *
         *  User profile . . . . . . . . . . :   *USER                        *
         *  Authority  . . . . . . . . . . . :   *LIBCRTAUT                   *
         *  Truncate numeric . . . . . . . . :   *YES                         *
         *  Fix numeric  . . . . . . . . . . :   *NONE                        *
         *  Allow null values  . . . . . . . :   *NO                          *
         *  Storage model . . .  . . . . . . :   *SNGLVL                      *
         *  Binding directory from Command . :   *NONE                        *
         *  Binding directory from Source  . :   ILEASTIC     NOXDB           *
         *    Library  . . . . . . . . . . . :     *LIBL        *LIBL         *
         *  Activation group . . . . . . . . :   *STGMDL                      *
         *  Enable performance collection  . :   *PEP                         *
         *  Profiling data . . . . . . . . . :   *NOCOL                       *
         *  Generate program interface . . . :   *NO                          *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page      4
 Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
         *--------------------------------------------------------------------*
     45+dcl-ds il_varchar qualified template;                                                                               1000033
     46+    length  int(10);                                                                                                1000034
     47+    string  pointer;                                                                                                1000035
     48+end-ds;                                                                                                             1000036
     49+                                                                                                                    1000037
     50+///                                                                                                                 1000038
     51+// Configuration                                                                                                    1000039
     52+///                                                                                                                 1000040
     53+dcl-ds il_config qualified template;                                                                                1000041
     54+    host    varchar(64);                                                                                            1000042
     55+    port    int(10);                                                                                                1000043
     56+    filler  char(4096);                                                                                             1000044
     57+end-ds;                                                                                                             1000045
     58+                                                                                                                    1000046
     59+///                                                                                                                 1000047
     60+// HTTP request                                                                                                     1000048
     61+//                                                                                                                  1000049
     62+// This data structure contains the values of the incoming                                                          1000050
     63+// HTTP request. The values can be retrieve by using the                                                            1000051
     64+// il_getVarcharValue procedure or by using one of the                                                              1000052
     65+// il_getRequest... procedures.                                                                                     1000053
     66+///                                                                                                                 1000054
     67+dcl-ds il_request qualified template;                                                                               1000055
     68+    config         pointer;                                                                                         1000056
     69+    method         likeds(il_varchar);                                                                              1000057
     70+    url            likeds(il_varchar);                                                                              1000058
     71+    resource       likeds(il_varchar);                                                                              1000059
     72+    queryString    likeds(il_varchar);                                                                              1000060
     73+    protocol       likeds(il_varchar);                                                                              1000061
     74+    headers        likeds(il_varchar);                                                                              1000062
     75+    content        likeds(il_varchar);                                                                              1000063
     76+    contentType    varchar(256);                                                                                    1000064
     77+    contentLength  uns(20);                                                                                         1000065
     78+    completeHeader likeds(il_varchar);                                                                              1000066
     79+    headerList     pointer;                                                                                         1000067
     80+end-ds;                                                                                                             1000068
     81+                                                                                                                    1000069
     82+///                                                                                                                 1000070
     83+// HTTP response                                                                                                    1000071
     84+//                                                                                                                  1000072
     85+// This data structure contains the details of the HTTP                                                             1000073
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page      5
 Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
     86+// response which will be sent by one of the il_response...                                                         1000074
     87+// procedures.                                                                                                      1000075
     88+///                                                                                                                 1000076
     89+dcl-ds il_response qualified template;                                                                              1000077
     90+    config      pointer;                                                                                            1000078
     91+    status      int(5);                                                                                             1000079
     92+    statusText  varchar(256);                                                                                       1000080
     93+    contentType varchar(256);                                                                                       1000081
     94+    charset     varchar(32) ;                                                                                       1000082
     95+end-ds;                                                                                                             1000083
     96+                                                                                                                    1000084
     97+///                                                                                                                 1000085
     98+// Get string value                                                                                                 1000086
     99+//                                                                                                                  1000087
    100+// Returns the value of a string data structure (il_varchar).                                                       1000088
    101+//                                                                                                                  1000089
    102+// Øparam String                                                                                                    1000090
    103+// Øreturn Value of the string data structure                                                                       1000091
    104+///                                                                                                                 1000092
    105+dcl-pr il_getVarcharValue varchar(524284:4) ccsid(*utf8) rtnparm                                                    1000093
    106+                extproc(*CWIDEN:'lvpc2lvc');                                                                        1000094
    107+    string likeds(il_varchar);                                                                                      1000095
    108+end-pr;                                                                                                             1000096
    109+                                                                                                                    1000097
    110+///                                                                                                                 1000098
    111+// Get HTTP request method                                                                                          1000099
    112+//                                                                                                                  1000100
    113+// Returns the HTTP method from the request (like GET, POST, DELETE, ...).                                          1000101
    114+//                                                                                                                  1000102
    115+// Øparam Request                                                                                                   1000103
    116+// Øreturn HTTP method                                                                                              1000104
    117+///                                                                                                                 1000105
    118+dcl-pr il_getRequestMethod  varchar(256:2) ccsid(*utf8) rtnparm                                                     1000106
    119+                extproc(*CWIDEN:'il_getRequestMethod');                                                             1000107
    120+    request likeds(il_request);                                                                                     1000108
    121+end-pr;                                                                                                             1000109
    122+                                                                                                                    1000110
    123+///                                                                                                                 1000111
    124+// Get request URL                                                                                                  1000112
    125+//                                                                                                                  1000113
    126+// Returns the request URL consisting of the resource and the query string.                                         1000114
    127+// http://localhost:8080/api/v1/iledocs/search?q=map&scope=full would return                                        1000115
    128+// /api/v1/iledocs/search?q=map&scope=full .                                                                        1000116
    129+// <br/><br/>                                                                                                       1000117
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page      6
 Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    130+// Any fragment entered in the request URL is not part of the return value.                                         1000118
    131+//                                                                                                                  1000119
    132+// Øparam Request                                                                                                   1000120
    133+// Øreturn URL                                                                                                      1000121
    134+///                                                                                                                 1000122
    135+dcl-pr il_getRequestUrl  varchar(524284:4) ccsid(*utf8) rtnparm                                                     1000123
    136+                extproc(*CWIDEN:'il_getRequestUrl');                                                                1000124
    137+    request likeds(il_request);                                                                                     1000125
    138+end-pr;                                                                                                             1000126
    139+                                                                                                                    1000127
    140+///                                                                                                                 1000128
    141+// Get request resource                                                                                             1000129
    142+//                                                                                                                  1000130
    143+// Return the full resources path excluding the query string and the fragment.                                      1000131
    144+// http://localhost:8080/api/v1/iledocs/search?q=map&scope=full would return                                        1000132
    145+// /api/v1/iledocs/search .                                                                                         1000133
    146+//                                                                                                                  1000134
    147+// Øparam Request                                                                                                   1000135
    148+// Øreturn Resource                                                                                                 1000136
    149+///                                                                                                                 1000137
    150+dcl-pr il_getRequestResource  varchar(524284:4) ccsid(*utf8) rtnparm                                                1000138
    151+                extproc(*CWIDEN:'il_getRequestResource');                                                           1000139
    152+    request likeds(il_request);                                                                                     1000140
    153+end-pr;                                                                                                             1000141
    154+                                                                                                                    1000142
    155+///                                                                                                                 1000143
    156+// Get request query string                                                                                         1000144
    157+//                                                                                                                  1000145
    158+// Returns the request query string (without the starting ? separator). So for                                      1000146
    159+// a request like http://localhost:8080/path?query=string you would get                                             1000147
    160+// query=string as the return value. The ? sign as a separator of the resource                                      1000148
    161+// path and the query string is not part of the return value. If the URL does                                       1000149
    162+// not contain a query string a zero length string is returned.                                                     1000150
    163+//                                                                                                                  1000151
    164+// Øparam Request                                                                                                   1000152
    165+// Øreturn Query string                                                                                             1000153
    166+///                                                                                                                 1000154
    167+dcl-pr il_getRequestQueryString  varchar(524284:4) ccsid(*utf8) rtnparm                                             1000155
    168+                extproc(*CWIDEN:'il_getRequestQueryString');                                                        1000156
    169+    request likeds(il_request);                                                                                     1000157
    170+end-pr;                                                                                                             1000158
    171+                                                                                                                    1000159
    172+///                                                                                                                 1000160
    173+// Get request protocol                                                                                             1000161
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page      7
 Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    174+//                                                                                                                  1000162
    175+// Returns the request protocol, f. e. HTTP/1.1 .                                                                   1000163
    176+//                                                                                                                  1000164
    177+// Øparam Request                                                                                                   1000165
    178+// Øreturn Protocol                                                                                                 1000166
    179+///                                                                                                                 1000167
    180+dcl-pr il_getRequestProtocol  varchar(256:2)  ccsid(*utf8) rtnparm                                                  1000168
    181+                extproc(*CWIDEN:'il_getRequestProtocol');                                                           1000169
    182+    request likeds(il_request);                                                                                     1000170
    183+end-pr;                                                                                                             1000171
    184+                                                                                                                    1000172
    185+///                                                                                                                 1000173
    186+// Get request headers                                                                                              1000174
    187+//                                                                                                                  1000175
    188+// Returns the request headers as they are in the HTTP message.                                                     1000176
    189+//                                                                                                                  1000177
    190+// Øparam Request                                                                                                   1000178
    191+// Øreturn HTTP headers                                                                                             1000179
    192+///                                                                                                                 1000180
    193+dcl-pr il_getRequestHeaders  varchar(524284:4)  ccsid(*utf8) rtnparm                                                1000181
    194+                extproc(*CWIDEN:'il_getRequestHeaders');                                                            1000182
    195+    request likeds(il_request);                                                                                     1000183
    196+end-pr;                                                                                                             1000184
    197+                                                                                                                    1000185
    198+///                                                                                                                 1000186
    199+// Get request header                                                                                               1000187
    200+//                                                                                                                  1000188
    201+// Returns a single request header.                                                                                 1000189
    202+//                                                                                                                  1000190
    203+// Øparam Request                                                                                                   1000191
    204+// Øreturn HTTP header                                                                                              1000192
    205+///                                                                                                                 1000193
    206+dcl-pr il_getRequestHeader  varchar(524284:4)  ccsid(*utf8) rtnparm                                                 1000194
    207+                extproc(*CWIDEN:'il_getRequestHeader');                                                             1000195
    208+    request  likeds(il_request);                                                                                    1000196
    209+    header   pointer value options(*string);                                                                        1000197
    210+end-pr;                                                                                                             1000198
    211+                                                                                                                    1000199
    212+///                                                                                                                 1000200
    213+// Get request content                                                                                              1000201
    214+//                                                                                                                  1000202
    215+// Returns the body content of the HTTP message. If the content exceeds                                             1000203
    216+// the length of the return value the subfield <em>content</em> of the                                              1000204
    217+// request data structure can be accessed directly to process the                                                   1000205
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page      8
 Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    218+// content block by block, see il_request.content.                                                                  1000206
    219+//                                                                                                                  1000207
    220+// Øparam Request                                                                                                   1000208
    221+// Øreturn HTTP message content                                                                                     1000209
    222+///                                                                                                                 1000210
    223+dcl-pr il_getContent  varchar(524284:4)  ccsid(*utf8) rtnparm                                                       1000211
    224+                extproc(*CWIDEN:'il_getContent');                                                                   1000212
    225+    request likeds(il_request);                                                                                     1000213
    226+end-pr;                                                                                                             1000214
    227+                                                                                                                    1000215
    228+///                                                                                                                 1000216
    229+// Get file MIME type                                                                                               1000217
    230+//                                                                                                                  1000218
    231+// If the requested resource is a file then the corresponding MIME type to                                          1000219
    232+// the file will be returned.                                                                                       1000220
    233+//                                                                                                                  1000221
    234+// Øparam Request                                                                                                   1000222
    235+// Øreturn MIME type                                                                                                1000223
    236+///                                                                                                                 1000224
    237+dcl-pr il_getFileMimeType  varchar(256:2)  rtnparm                                                                  1000225
    238+                extproc(*CWIDEN:'il_getFileMimeType');                                                              1000226
    239+    fileName    varchar(256:2);                                                                                     1000227
    240+end-pr;                                                                                                             1000228
    241+                                                                                                                    1000229
    242+///                                                                                                                 1000230
    243+// Get file extension                                                                                               1000231
    244+//                                                                                                                  1000232
    245+// If the requested resource is a file then the file extension will be returned.                                    1000233
    246+// A request for http://localhost:8080/index.html will return html.                                                 1000234
    247+//                                                                                                                  1000235
    248+// Øparam Request                                                                                                   1000236
    249+// Øreturn file extension                                                                                           1000237
    250+///                                                                                                                 1000238
    251+dcl-pr il_getFileExtension  varchar(256:2)  rtnparm                                                                 1000239
    252+                extproc(*CWIDEN:'il_getFileExtension');                                                             1000240
    253+    fileName    varchar(256:2);                                                                                     1000241
    254+end-pr;                                                                                                             1000242
    255+                                                                                                                    1000243
    256+///                                                                                                                 1000244
    257+// Start server                                                                                                     1000245
    258+//                                                                                                                  1000246
    259+// Starts the server with the passed configuration and for the passed servlet.                                      1000247
    260+//                                                                                                                  1000248
    261+// Øparam Configuration                                                                                             1000249
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page      9
 Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    262+// Øparam Servlet                                                                                                   1000250
    263+///                                                                                                                 1000251
    264+dcl-pr il_listen extproc(*CWIDEN:'il_listen');                                                                      1000252
    265+    config      likeds(il_config);                                                                                  1000253
    266+    servlet     pointer(*PROC) value options(*nopass) ;                                                             1000254
    267+end-pr;                                                                                                             1000255
    268+                                                                                                                    1000256
    269+///                                                                                                                 1000257
    270+// Write response                                                                                                   1000258
    271+//                                                                                                                  1000259
    272+// Writes the passed buffer to the HTTP message. This procedure can be called                                       1000260
    273+// multiple times for a single HTTP response. The buffers content will be                                           1000261
    274+// concated to a single HTTP message body.                                                                          1000262
    275+//                                                                                                                  1000263
    276+// Øparam Response                                                                                                  1000264
    277+// Øparam Response message content.                                                                                 1000265
    278+//                                                                                                                  1000266
    279+// Øinfo The response data structure must be filled with the correct values                                         1000267
    280+//       (f. e. the HTTP status code) for the response on the first call of                                         1000268
    281+//       this procedure for the HTTP response.                                                                      1000269
    282+///                                                                                                                 1000270
    283+dcl-pr il_responseWrite extproc(*CWIDEN:'il_responseWrite');                                                        1000271
    284+    response    likeds(il_response);                                                                                1000272
    285+    buffer      varchar(524284:4) ccsid(*utf8) options(*varsize) const ;                                            1000273
    286+end-pr;                                                                                                             1000274
    287+                                                                                                                    1000275
    288+///                                                                                                                 1000276
    289+// Write binary response                                                                                            1000277
    290+//                                                                                                                  1000278
    291+// Writes the passed buffer to the HTTP message. This procedure can be called                                       1000279
    292+// multiple times for a single HTTP response. The buffers content will be                                           1000280
    293+// concated to a single HTTP message body. The content of the message will be                                       1000281
    294+// written as is to the HTTP message without any character conversion.                                              1000282
    295+//                                                                                                                  1000283
    296+// Øparam Response                                                                                                  1000284
    297+// Øparam Response message content.                                                                                 1000285
    298+//                                                                                                                  1000286
    299+// Øinfo The response data structure must be filled with the correct values                                         1000287
    300+//       (f. e. the HTTP status code) for the response on the first call of                                         1000288
    301+//       this procedure for the HTTP response.                                                                      1000289
    302+///                                                                                                                 1000290
    303+dcl-pr il_responseWriteBin extproc(*CWIDEN:'il_responseWrite');                                                     1000291
    304+    response    likeds(il_response);                                                                                1000292
    305+    buf         varchar(524284:4) options(*varsize) const ;                                                         1000293
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     10
 Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    306+end-pr;                                                                                                             1000294
    307+                                                                                                                    1000295
    308+///                                                                                                                 1000296
    309+// Serve file                                                                                                       1000297
    310+//                                                                                                                  1000298
    311+// Writes the content of the file to the response message.                                                          1000299
    312+//                                                                                                                  1000300
    313+// Øparam Response                                                                                                  1000301
    314+// Øparam Filename                                                                                                  1000302
    315+///                                                                                                                 1000303
    316+dcl-pr il_serveStatic ind extproc(*CWIDEN:'il_serveStatic');                                                        1000304
    317+    response    likeds(il_response);                                                                                1000305
    318+    fileName    varchar(256) options(*varsize) const;                                                               1000306
    319+end-pr;                                                                                                             1000307
    320+                                                                                                                    1000308
    321+///                                                                                                                 1000309
    322+// Write stream                                                                                                     1000310
    323+//                                                                                                                  1000311
    324+// Writes the content of the stream to the response message.                                                        1000312
    325+//                                                                                                                  1000313
    326+// Øparam Response                                                                                                  1000314
    327+// Øparam Stream                                                                                                    1000315
    328+///                                                                                                                 1000316
    329+dcl-pr il_responseWriteStream extproc(*CWIDEN:'il_responseWriteStream');                                            1000317
    330+    response    likeds(il_response);                                                                                1000318
    331+    stream      pointer value; // Pointer returned by i.e. json_stream from noxDB                                   1000319
    332+end-pr;                                                                                                             1000320
    333+                                                                                                                    1000321
    334+// Methods ( can be added like IL_GET + IL_POST)                                                                    1000322
    335+dcl-c IL_GET     const(1);                                                                                          1000323
    336+dcl-c IL_POST    const(2);                                                                                          1000324
    337+dcl-c IL_DELETE  const(4);                                                                                          1000325
    338+dcl-c IL_PUT     const(8);                                                                                          1000326
    339+dcl-c IL_ANY     const(1023);                                                                                       1000327
    340+                                                                                                                    1000328
    341+dcl-pr il_addRoute  extproc(*CWIDEN:'il_addRoute');                                                                 1000329
    342+    config       likeds(il_config);                                                                                 1000330
    343+    servlet      pointer(*PROC) value;                                                                              1000331
    344+    methods      int(5) value options(*nopass);                                                                     1000332
    345+    route        varchar(1024) const options(*nopass);                                                              1000333
    346+    contentstype varchar(1024) const options(*nopass);                                                              1000334
    347+end-pr;                                                                                                             1000335
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     11
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    348    /include ./headers/JSONparser.rpgle                                                                               000014
         *--------------------------------------------------------------------------------------------*
         * RPG member name  . . . . . :  JSONparse+                                                   *                     2
         * External name  . . . . . . :  /prj/noxdb/./headers/JSONparser.rpgle                        *                     2
         * Last change  . . . . . . . :  17-09-18  14:18:17                                           *                     2
         *--------------------------------------------------------------------------------------------*
    349+   //---------------------------------------------------------------------- *                                       2000001
    350+   //This is the prototype for BlueSeries/IceBreak - JSON and XML parser                                            2000002
    351+   //Use the JSONXML binddir when creating your program and include this                                            2000003
    352+   //prototypes like:                                                                                               2000004
    353+                                                                                                                    2000005
    354+   //H BNDDIR('JSONPARSER')                                                                                         2000006
    355+   ///include jsonParser                                                                                            2000007
    356+                                                                                                                    2000008
    357+   //Or                                                                                                             2000009
    358+                                                                                                                    2000010
    359+   //H BNDDIR('XMLPARSER')                                                                                          2000011
    360+   ///include xmlParser                                                                                             2000012
    361+                                                                                                                    2000013
    362+   //Note: Both XMLPARSER and JSONPARSER headers are autogenerated from                                             2000014
    363+   //the JSONXML header. so please do not make any changes th there headerfi                                        2000015
    364+                                                                                                                    2000016
    365+   //Note: all binddirectories JSONPARSER, XMLPARSER and JSONXML is the same                                        2000017
    366+   //---------------------------------------------------------------------- *                                       2000018
    367+ /if defined( json_DEF)                                                                                             2000019
             LINES EXCLUDED: 1
    368+ /endif                                                                                                             2000021
    369+ /define  json_DEF                                                                                                  2000022
    370+   //---------------------------------------------------------------------- *                                       2000023
    371+   //Before starting that parser - to enshure right enterpretations of delimi                                       2000024
    372+   //Usage:                                                                                                         2000025
    373+   //jx_setDelimiters( json_DELIMITERS);                                                                            2000026
    374+   //--------------------------------------------------------------------- *                                        2000027
    375+   //get delimiter pointer                                                                                          2000028
    376+   Dcl-PR json_getDelimiters Pointer extproc(*CWIDEN :'jx_GetDelimiters');                                          2000029
    377+   End-PR;                                                                                                          2000030
    378+   //Set delimiter used for locate expression                                                                       2000031
    379+   Dcl-PR json_setDelimiters  extproc(*CWIDEN :'jx_SetDelimiters2');                                                2000032
    380+     //always: '/\Ø#¤ .æå' in your  local CCSID                                                                     2000033
    381+     delimiterStr   Pointer    value options(*string);                                              I               2000034
    382+   End-PR;                                                                                                          2000035
    383+                                                                                                                    2000036
    384+   Dcl-C json_DELIMITERS const('/\Ø#¤ .æå''"');                                                                     2000037
    385+                                                                                                                    2000038
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     12
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    386+   //---------------------------------------------------------------------- *                                       2000039
    387+   //Type of a node:                                                                                                2000040
    388+   //---------------------------------------------------------------------- *                                       2000041
    389+   Dcl-C json_UNKNOWN const(0);                                                                                     2000042
    390+   Dcl-C json_OBJECT  const(1);                                                                                     2000043
    391+   Dcl-C json_ARRAY   const(2);                                                                                     2000044
    392+   Dcl-C json_EVAL    const(3);                                                                                     2000045
    393+   Dcl-C json_POINTER_VALUE const(4);                                                                               2000046
    394+   Dcl-C json_VALUE   const(5);                                                                                     2000047
    395+   Dcl-C json_ROOT    const(6);                                                                                     2000048
    396+   Dcl-C json_LITERAL const(16);                                                                                    2000049
    397+   Dcl-C json_OBJLINK const(17);                                                                                    2000050
    398+   Dcl-C json_OBJREPLACE const(18);                                                                                 2000051
    399+   Dcl-C json_OBJCOPY const(18);                                                                                    2000052
    400+   Dcl-C json_BY_CONTEXT const(19);                                                                                 2000053
    401+   Dcl-C json_OBJMOVE const(2048);                                                                                  2000054
    402+                                                                                                                    2000055
    403+   //* Modifiers to "add" / "or" into "parseString" and "evaluate"                                                  2000056
    404+   //!! Type - have to be backwards compat.                                                                         2000057
    405+   //Unlink the source and move it to dest.                                                                         2000058
    406+   Dcl-C json_MOVE_MODES const(2048);                                                                               2000059
    407+   //Allow strings ints and other values to                                                                         2000060
    408+   Dcl-C json_ALLOW_PRIMITIVES const(4096);                                                                         2000061
    409+                                                                                                                    2000062
    410+   //* Combinations:                                                                                                2000063
    411+   //JX_PARSE  = json_EVAL + json_MOVE_NODES                                                                        2000064
    412+   Dcl-C json_PARSE   const(2051);                                                                                  2000065
    413+                                                                                                                    2000066
    414+   //Merge options:                                                                                                 2000067
    415+   //Modifiers to "add" / "or" into "JSON_EVAL"                                                                     2000068
    416+ /if not defined(MO_MERGE)                                                                                          2000069
    417+ /define  MO_MERGE                                                                                                  2000070
    418+   //Only new elements are merged - existing                                                                        2000071
    419+   //are left untouched                                                                                             2000072
    420+   Dcl-C MO_MERGE_NEW const(256);                                                                                   2000073
    421+   //Merge and replace only existing nodes.                                                                         2000074
    422+   Dcl-C MO_MERGE_MATCH const(512);                                                                                 2000075
    423+   //Merge all: replace if it exists and                                                                            2000076
    424+   //append new nodes if not exists                                                                                 2000077
    425+   Dcl-C MO_MERGE_REPLACE const(1024 );                                                                             2000078
    426+ /endif                                                                                                             2000079
    427+                                                                                                                    2000080
    428+   Dcl-C json_CHILD_LIST const('#0¤');                                                                              2000081
    429+                                                                                                                    2000082
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     13
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    430+   //---------------------------------------------------------------------- *                                       2000083
    431+   //Returns node to the json_object tree                                                                           2000084
    432+   Dcl-PR json_ParseFile Pointer extproc(*CWIDEN:'jx_ParseFile');                                   I               2000085
    433+     //File to parse                                                                                                2000086
    434+     FileName       Pointer    value options(*string);                                              I               2000087
    435+     //Parsing options                                                                                              2000088
    436+     Options        Pointer    value options(*string:*nopass);                                      I               2000089
    437+   End-PR;                                                                                                          2000090
    438+                                                                                                                    2000091
    439+   //Returns node json_object tree                                                                                  2000092
    440+   Dcl-PR json_ParseString Pointer extproc(*CWIDEN:'jx_ParseString');                               I               2000093
    441+     //String to parse                                                                                              2000094
    442+     String         Pointer    value options(*string);                                              I               2000095
    443+     //Parsing options                                                                                              2000096
    444+     Options        Pointer    value options(*string:*nopass);                                      I               2000097
    445+   End-PR;                                                                                                          2000098
    446+                                                                                                                    2000099
    447+   //Set , or . for numeri decimal point                                                                            2000100
    448+   Dcl-PR json_setDecPoint  extproc(*CWIDEN : 'jx_SetDecPoint');                                                    2000101
    449+     //decimal point char                                                                                           2000102
    450+     decPoint       Pointer    value options(*string);                                                              2000103
    451+   End-PR;                                                                                                          2000104
    452+                                                                                                                    2000105
    453+                                                                                                                    2000106
    454+                                                                                                                    2000107
    455+   //Bool true if errors occures                                                                                    2000108
    456+   Dcl-PR json_Error Ind extproc(*CWIDEN:'jx_Error');                                               I               2000109
    457+     //jx_Object  node                                                                                              2000110
    458+     pNode          Pointer    value;                                                               I               2000111
    459+   End-PR;                                                                                                          2000112
    460+                                                                                                                    2000113
    461+   //Return error description                                                                                       2000114
    462+   Dcl-PR json_Message Varchar(1024) extproc(*CWIDEN:'jx_Message');                                 I               2000115
    463+     //jx_Object                                                                                                    2000116
    464+     pNode          Pointer    value;                                                               I               2000117
    465+   End-PR;                                                                                                          2000118
    466+                                                                                                                    2000119
    467+   //Returns pointer to node                                                                                        2000120
    468+   Dcl-PR json_Locate Pointer extproc(*CWIDEN : 'jx_GetNode');                                      I               2000121
    469+     //Pointer to tree or node                                                                                      2000122
    470+     pNode          Pointer    value;                                                               I               2000123
    471+     //location expression                                                                                          2000124
    472+     Expression     Pointer    value options(*string);                                              I               2000125
    473+   End-PR;                                                                                                          2000126
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     14
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    474+                                                                                                                    2000127
    475+   //Returns pointer to node                                                                                        2000128
    476+   Dcl-PR json_LocateOrCreate Pointer                                                               I               2000129
    477+                            extproc(*CWIDEN : 'jx_GetOrCreateNode');                                                2000130
    478+     //Pointer to tree or node                                                                                      2000131
    479+     pNode          Pointer    value;                                                               I               2000132
    480+     //location expression                                                                                          2000133
    481+     Expression     Pointer    value options(*string);                                              I               2000134
    482+   End-PR;                                                                                                          2000135
    483+                                                                                                                    2000136
    484+   //Returns 'ON' if node exists                                                                                    2000137
    485+   Dcl-PR json_Has Ind extproc(*CWIDEN : 'jx_Has');                                                 I               2000138
    486+     //Pointer to tree or node                                                                                      2000139
    487+     pNode          Pointer    value;                                                               I               2000140
    488+     //Path to node                                                                                                 2000141
    489+     NodeName       Pointer    value options(*string);                                              I               2000142
    490+   End-PR;                                                                                                          2000143
    491+                                                                                                                    2000144
    492+   //Returns 'ON' if node exists and has <> 0                                                                       2000145
    493+   Dcl-PR json_isTrue Ind extproc(*CWIDEN : 'jx_IsTrue');                                           I               2000146
    494+     //Pointer to tree or node                                                                                      2000147
    495+     pNode          Pointer    value;                                                               I               2000148
    496+     //Path to node                                                                                                 2000149
    497+     NodeName       Pointer    value options(*string);                                              I               2000150
    498+   End-PR;                                                                                                          2000151
    499+                                                                                                                    2000152
    500+   //Returns 'ON' if node exists and has <> 0                                                                       2000153
    501+   Dcl-PR json_isNull Ind extproc(*CWIDEN : 'jx_IsNull');                                           I               2000154
    502+     //Pointer to tree or node                                                                                      2000155
    503+     pNode          Pointer    value;                                                               I               2000156
    504+     //Path to node                                                                                                 2000157
    505+     NodeName       Pointer    value options(*string);                                              I               2000158
    506+   End-PR;                                                                                                          2000159
    507+                                                                                                                    2000160
    508+   //Returns 'ON' if it is a valid node                                                                             2000161
    509+   Dcl-PR json_isNode Ind extproc(*CWIDEN : 'jx_isNode');                                           I               2000162
    510+     //a.k.a. false for strings                                                                                     2000163
    511+     pNode          Pointer    value;                                                               I               2000164
    512+   End-PR;                                                                                                          2000165
    513+                                                                                                                    2000166
    514+   //renames the node name                                                                                          2000167
    515+   Dcl-PR json_NodeRename Ind extproc(*CWIDEN : 'jx_NodeRename');                                   I               2000168
    516+     //Pointer to tree or node                                                                                      2000169
    517+     pNode          Pointer    value;                                                               I               2000170
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     15
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    518+     //Path to node                                                                                                 2000171
    519+     NodeName       Pointer    value options(*string);                                              I               2000172
    520+   End-PR;                                                                                                          2000173
    521+                                                                                                                    2000174
    522+   //Returns pointer to next sibling (elem)                                                                         2000175
    523+   Dcl-PR json_GetNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                                 I               2000176
    524+     //Pointer to current node (elem)                                                                               2000177
    525+     pNode          Pointer    value;                                                               I               2000178
    526+   End-PR;                                                                                                          2000179
    527+                                                                                                                    2000180
    528+   //Returns pointer to first child (elem)                                                                          2000181
    529+   Dcl-PR json_GetChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                               I               2000182
    530+     //Pointer to current node (elem)                                                                               2000183
    531+     pNode          Pointer    value;                                                               I               2000184
    532+   End-PR;                                                                                                          2000185
    533+                                                                                                                    2000186
    534+   //Returns pointer to parent node                                                                                 2000187
    535+   Dcl-PR json_GetParent Pointer extproc(*CWIDEN : 'jx_GetNodeParent');                             I               2000188
    536+     //Pointer to current node (elem)                                                                               2000189
    537+     pNode          Pointer    value;                                                               I               2000190
    538+   End-PR;                                                                                                          2000191
    539+                                                                                                                    2000192
    540+   Dcl-PR json_SetStr Pointer extproc(*CWIDEN: 'jx_SetStrByName');                                                  2000193
    541+     //Pointer to json_ tree                                                                                        2000194
    542+     pNode          Pointer    value;                                                                               2000195
    543+     //X-path locations to node or attributes                                                                       2000196
    544+     Expresion      Pointer    value options(*string);                                                              2000197
    545+     //New value to set / pointer to object                                                                         2000198
    546+     Value          Pointer    value options(*string);                                                              2000199
    547+   End-PR;                                                                                                          2000200
    548+                                                                                                                    2000201
    549+   Dcl-PR json_SetInt Pointer extproc(*CWIDEN: 'jx_SetIntByName');                                                  2000202
    550+     //Pointer to json_ tree                                                                                        2000203
    551+     pNode          Pointer    value;                                                                               2000204
    552+     //X-path locations to node or attributes                                                                       2000205
    553+     Expresion      Pointer    value options(*string);                                                              2000206
    554+     //New value to set / pointer to object                                                                         2000207
    555+     Value          Int(10)    value;                                                                               2000208
    556+   End-PR;                                                                                                          2000209
    557+                                                                                                                    2000210
    558+   Dcl-PR json_SetNum Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  2000211
    559+     //Pointer to json_ tree                                                                                        2000212
    560+     pNode          Pointer    value;                                                                               2000213
    561+     //X-path locations to node or attributes                                                                       2000214
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     16
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    562+     Expresion      Pointer    value options(*string);                                                              2000215
    563+     //New value to set / pointer to object                                                                         2000216
    564+     Value          Packed(30:15) value;                                                                            2000217
    565+   End-PR;                                                                                                          2000218
    566+                                                                                                                    2000219
    567+   Dcl-PR json_SetBool Pointer extproc(*CWIDEN: 'jx_SetBoolByName');                                                2000220
    568+     //Pointer to json_ tree                                                                                        2000221
    569+     pNode          Pointer    value;                                                                               2000222
    570+     //X-path locations to node or attributes                                                                       2000223
    571+     Expresion      Pointer    value options(*string);                                                              2000224
    572+     //New value to set / pointer to object                                                                         2000225
    573+     Value          Ind        value;                                                                               2000226
    574+   End-PR;                                                                                                          2000227
    575+                                                                                                                    2000228
    576+   Dcl-PR json_SetPtr Pointer extproc(*CWIDEN: 'jx_SetPtrByName');                                                  2000229
    577+     //Pointer to json_ tree                                                                                        2000230
    578+     pNode          Pointer    value;                                                                               2000231
    579+     //X-path locations to node or attributes                                                                       2000232
    580+     Expresion      Pointer    value options(*string);                                                              2000233
    581+     //Pointer to anything - You do the cleanup                                                                     2000234
    582+     Value          Pointer    value;                                                                               2000235
    583+   End-PR;                                                                                                          2000236
    584+                                                                                                                    2000237
    585+   Dcl-PR json_SetValue Pointer extproc(*CWIDEN: 'jx_SetValueByName');                                              2000238
    586+     //Pointer to json_ tree                                                                                        2000239
    587+     pNode          Pointer    value;                                                                               2000240
    588+     //X-path locations to node or attributes                                                                       2000241
    589+     Expresion      Pointer    value options(*string);                                                              2000242
    590+     //New value to set / pointer to object                                                                         2000243
    591+     Value          Pointer    value options(*string:*nopass);                                                      2000244
    592+     //Optional new type (Refer "node type"                                                                         2000245
    593+     Type           Uns(5)     value options(*nopass);                                                              2000246
    594+   End-PR;                                                                                                          2000247
    595+                                                                                                                    2000248
    596+   Dcl-PR json_GetValueStr Varchar(32767)                                                           I               2000249
    597+                         extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                    2000250
    598+     //Pointer to node                                                                                              2000251
    599+     pNode          Pointer    value;                                                               I               2000252
    600+     //If not found - default value                                                                                 2000253
    601+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000254
    602+   End-PR;                                                                                                          2000255
    603+                                                                                                                    2000256
    604+   Dcl-PR json_GetValueNum Packed(30:15)                                                            I               2000257
    605+                         extproc(*CWIDEN : 'jx_GetNodeValueNum');                                                   2000258
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     17
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    606+     //Pointer to node                                                                                              2000259
    607+     pNode          Pointer    value;                                                               I               2000260
    608+     //If not found - default value                                                                                 2000261
    609+     Defaultvalue   Packed(30:15) value options(*NOPASS);                                           I               2000262
    610+   End-PR;                                                                                                          2000263
    611+                                                                                                                    2000264
    612+   Dcl-PR json_GetValuePtr Pointer extproc(*CWIDEN : 'jx_GetNodeValuePtr');                         I               2000265
    613+     //Pointer to node                                                                                              2000266
    614+     pNode          Pointer    value;                                                               I               2000267
    615+     //If not found - default value                                                                                 2000268
    616+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000269
    617+   End-PR;                                                                                                          2000270
    618+                                                                                                                    2000271
    619+   Dcl-PR json_GetName Varchar(32767)                                                               I               2000272
    620+                     extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                         2000273
    621+     //Pointer to node                                                                                              2000274
    622+     pNode          Pointer    value;                                                               I               2000275
    623+   End-PR;                                                                                                          2000276
    624+                                                                                                                    2000277
    625+   Dcl-PR json_GetNameAsPath Varchar(32767)                                                         I               2000278
    626+                           extproc(*CWIDEN : 'jx_GetNodeNameAsPath');                                               2000279
    627+     //Pointer to node                                                                                              2000280
    628+     pNode          Pointer    value;                                                               I               2000281
    629+     //Delimiter like - or . or / or \                                                                              2000282
    630+     Delimiter      Char(1)    value;                                                               I               2000283
    631+   End-PR;                                                                                                          2000284
    632+                                                                                                                    2000285
    633+   //* Refer to node type above                                                                                     2000286
    634+   Dcl-PR json_NodeType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                                 I               2000287
    635+     //Pointer to json_ tree to receive format                                                                      2000288
    636+     pNode          Pointer    value;                                                               I               2000289
    637+   End-PR;                                                                                                          2000290
    638+                                                                                                                    2000291
    639+ // Get string by expresion                                                                                         2000292
    640+ //  /object/array#123¤/name                                                                                        2000293
    641+ //  .object.array#123¤.name                                                                                        2000294
    642+   Dcl-PR json_GetStr Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                                            2000295
    643+     //Pointer to relative node                                                                                     2000296
    644+     pNode          Pointer    value;                                                                               2000297
    645+     //Locations expression to node                                                                                 2000298
    646+     Expression     Pointer    value options(*string:*nopass);                                                      2000299
    647+     //If not found - default value                                                                                 2000300
    648+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      2000301
    649+   End-PR;                                                                                                          2000302
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     18
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    650+                                                                                                                    2000303
    651+ //  will join all subsequent array nodes into one resulting string                                                 2000304
    652+   Dcl-PR json_GetStrJoin Varchar(32767)                                                                            2000305
    653+                        extproc(*CWIDEN : 'jx_GetStrJoinVC');                                                       2000306
    654+     //Pointer to relative node                                                                                     2000307
    655+     pNode          Pointer    value;                                                                               2000308
    656+     //Locations expression to node                                                                                 2000309
    657+     Expression     Pointer    value options(*string:*nopass);                                                      2000310
    658+     //If not found - default value                                                                                 2000311
    659+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      2000312
    660+   End-PR;                                                                                                          2000313
    661+                                                                                                                    2000314
    662+ // Get number by expresion like:                                                                                   2000315
    663+ //  /object/array#123¤/name                                                                                        2000316
    664+ //  .object.array#123¤.name                                                                                        2000317
    665+   Dcl-PR json_GetNum Packed(30:15) extproc(*CWIDEN : 'jx_GetValueNum');                                            2000318
    666+     //Pointer to relative node                                                                                     2000319
    667+     pNode          Pointer    value;                                                                               2000320
    668+     //Locations expression to node                                                                                 2000321
    669+     Expression     Pointer    value options(*string:*nopass);                                                      2000322
    670+     //If not found - default value                                                                                 2000323
    671+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           2000324
    672+   End-PR;                                                                                                          2000325
    673+                                                                                                                    2000326
    674+   Dcl-PR json_GetInt Int(20) extproc(*CWIDEN : 'jx_GetValueInt');                                                  2000327
    675+     //Pointer to relative node                                                                                     2000328
    676+     pNode          Pointer    value;                                                                               2000329
    677+     //Locations expression to node                                                                                 2000330
    678+     Expression     Pointer    value options(*string:*nopass);                                                      2000331
    679+     //If not found - default value                                                                                 2000332
    680+     Defaultvalue   Int(20)    value options(*nopass);                                                              2000333
    681+   End-PR;                                                                                                          2000334
    682+                                                                                                                    2000335
    683+   //Set an ILOB object to a value found by X                                                       I               2000336
    684+   //Return *ON if found                                                                                            2000337
    685+   Dcl-PR json_GetIlobValue Ind extproc(*CWIDEN :'ILOB_XmlGetValue');                               I               2000338
    686+     //Pointer to ILOB object to receive the va                                                                     2000339
    687+     pIlob          Pointer    value;                                                               I               2000340
    688+     //Pointer to tree                                                                                              2000341
    689+     pNode          Pointer    value;                                                               I               2000342
    690+     //X-path locations to node or attributes                                                                       2000343
    691+     Expression     Pointer    value options(*string);                                              I               2000344
    692+   End-PR;                                                                                                          2000345
    693+                                                                                                                    2000346
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     19
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    694+   Dcl-PR json_CopyValue Pointer extproc(*CWIDEN : 'jx_CopyValue');                                                 2000347
    695+     //destination node                                                                                             2000348
    696+     pDest          Pointer    value;                                                                               2000349
    697+     //destiantion name (or *NULL or '')                                                                            2000350
    698+     destName       Pointer    value options(*string);                                                              2000351
    699+     //source node                                                                                                  2000352
    700+     pSource        Pointer    value;                                                                               2000353
    701+     //source name (or *NULL or '')                                                                                 2000354
    702+     sourceName     Pointer    value options(*string);                                                              2000355
    703+   End-PR;                                                                                                          2000356
    704+                                                                                                                    2000357
    705+   Dcl-PR json_NodeCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                           2000358
    706+     //node. Retrive from Locate()                                                                                  2000359
    707+     pRootNode      Pointer    value;                                                                               2000360
    708+     //node. Retrive from Locate()                                                                                  2000361
    709+     pNewChild      Pointer    value;                                                                               2000362
    710+     //Reference location to where it arrive                                                                        2000363
    711+     RefLocation    Int(10)    value;                                                                               2000364
    712+   End-PR;                                                                                                          2000365
    713+                                                                                                                    2000366
    714+   //Following constants used by json_NodeCopy:RefLocation                                                          2000367
    715+   Dcl-C json_FIRST_CHILD const(1);                                                                                 2000368
    716+   Dcl-C json_LAST_CHILD const(2);                                                                                  2000369
    717+   Dcl-C json_BEFORE_SIBLING const(3);                                                                              2000370
    718+   Dcl-C json_AFTER_SIBLING const(4);                                                                               2000371
    719+                                                                                                                    2000372
    720+   Dcl-PR json_NodeClone Pointer extproc(*CWIDEN : 'jx_NodeClone');                                                 2000373
    721+     //node. Retrive from Locate()                                                                                  2000374
    722+     pSource        Pointer    value;                                                                               2000375
    723+   End-PR;                                                                                                          2000376
    724+                                                                                                                    2000377
    725+   //returns the new node                                                                                           2000378
    726+   Dcl-PR json_NodeAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                     2000379
    727+     //node. Retrive from Locate()                                                                                  2000380
    728+     pRootNode      Pointer    value;                                                                               2000381
    729+     //Reference location to where it arrive                                                                        2000382
    730+     RefLocation    Int(10)    value;                                                                               2000383
    731+     //Name of node                                                                                                 2000384
    732+     Name           Pointer    value options(*string);                                              I               2000385
    733+     //Value or expression                                                                                          2000386
    734+     Value          Pointer    value options(*string);                                              I               2000387
    735+     //New type (Refer "node type"                                                                                  2000388
    736+     Type           Uns(5)     value;                                                                               2000389
    737+   End-PR;                                                                                                          2000390
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     20
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    738+                                                                                                                    2000391
    739+   Dcl-PR json_NodeDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                       2000392
    740+     //node. Retrive from Locate()                                                                                  2000393
    741+     pRootNode      Pointer    value;                                                                               2000394
    742+   End-PR;                                                                                                          2000395
    743+                                                                                                                    2000396
    744+   Dcl-PR json_NodeSanitize extproc(*CWIDEN : 'jx_NodeSanitize');                                                   2000397
    745+     //node. Retrive from Locate()                                                                                  2000398
    746+     pRootNode      Pointer    value;                                                                               2000399
    747+   End-PR;                                                                                                          2000400
    748+                                                                                                                    2000401
    749+   //CheckSum of all names and values                                                                               2000402
    750+   //Delete all nodes which value are null                                                                          2000403
    751+   Dcl-PR json_NodeCheckSum Uns(10) extproc(*CWIDEN : 'jx_NodeCheckSum');                                           2000404
    752+     pRootNode      Pointer    value; //node. Retrive from Locate()                                                 2000405
    753+   End-PR;                                                                                                          2000406
    754+                                                                                                                    2000407
    755+   //returns the new node                                                                                           2000408
    756+   Dcl-PR json_NewObject Pointer extproc(*CWIDEN : 'jx_NewObject');                                                 2000409
    757+     //Destination. Retrive from Locate()                                                                           2000410
    758+     pDestNode      Pointer    value options(*nopass);                                                              2000411
    759+   End-PR;                                                                                                          2000412
    760+                                                                                                                    2000413
    761+ // Array functions                                                                                                 2000414
    762+   //returns the new node                                                                                           2000415
    763+   Dcl-PR json_NewArray Pointer extproc(*CWIDEN : 'jx_NewArray');                                                   2000416
    764+     //Destination. Retrive from Locate()                                                                           2000417
    765+     pDestNode      Pointer    value options(*nopass);                                                              2000418
    766+   End-PR;                                                                                                          2000419
    767+                                                                                                                    2000420
    768+   //returns the new node added to the end of                                                                       2000421
    769+   Dcl-PR json_ArrayPush Pointer extproc(*CWIDEN : 'jx_ArrayPush');                                                 2000422
    770+     //Destination. Retrive from Locate()                                                                           2000423
    771+     pDestArray     Pointer    value;                                                                               2000424
    772+     //source node to append                                                                                        2000425
    773+     pSourceNode    Pointer    value options(*string);                                                              2000426
    774+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      2000427
    775+     copy           Uns(5)     value options(*nopass);                                                              2000428
    776+   End-PR;                                                                                                          2000429
    777+                                                                                                                    2000430
    778+   //Following constants used by json_ArrayPush:copy                                                                2000431
    779+   Dcl-C json_MOVE_UNLINK const(0);                                                                                 2000432
    780+   Dcl-C json_COPY_CLONE const(1);                                                                                  2000433
    781+                                                                                                                    2000434
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     21
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    782+   //returns the new node added to the end of                                                                       2000435
    783+   Dcl-PR json_ArrayAppend Pointer extproc(*CWIDEN :'jx_ArrayAppend');                                              2000436
    784+     //Destination. Retrive from Locate()                                                                           2000437
    785+     pDestArray     Pointer    value;                                                                               2000438
    786+     //source node to append                                                                                        2000439
    787+     pSourceNode    Pointer    value options(*string);                                                              2000440
    788+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      2000441
    789+     copy           Uns(5)     value options(*nopass);                                                              2000442
    790+   End-PR;                                                                                                          2000443
    791+                                                                                                                    2000444
    792+   //returns the new array fro source array                                                                         2000445
    793+   Dcl-PR json_ArraySlice Pointer extproc(*CWIDEN : 'jx_ArraySlice' );                                              2000446
    794+     //source node or array string                                                                                  2000447
    795+     pSourceNode    Pointer    value options(*string);                                                              2000448
    796+     //From entry ( 1=First)                                                                                        2000449
    797+     from           Int(10)    value;                                                                               2000450
    798+     //To and includ   (-1 = Until end)                                                                             2000451
    799+     to             Int(10)    value;                                                                               2000452
    800+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      2000453
    801+     copy           Uns(5)     value options(*nopass);                                                              2000454
    802+   End-PR;                                                                                                          2000455
    803+                                                                                                                    2000456
    804+   //returns the new node added to the end of                                                                       2000457
    805+   Dcl-PR json_ArraySort Pointer extproc(*CWIDEN : 'jx_ArraySort');                                                 2000458
    806+     //Destination. Retrive from Locate()                                                                           2000459
    807+     pArray         Pointer    value;                                                                               2000460
    808+     //nodenames if any in subobject to comapre                                                                     2000461
    809+     pkeyNames      Pointer    value options(*string) ;                                                             2000462
    810+   End-PR;                                                                                                          2000463
    811+                                                                                                                    2000464
    812+   Dcl-C json_USE_LOCALE const(1);                                                                                  2000465
    813+                                                                                                                    2000466
    814+   //returns the first node with expr value                                                                         2000467
    815+   Dcl-PR json_LookupValue Pointer extproc(*CWIDEN : 'jx_lookupValue');                                             2000468
    816+     //Array/ obj to search                                                                                         2000469
    817+     pArray         Pointer    value;                                                                               2000470
    818+     //What to search for                                                                                           2000471
    819+     expr           Pointer    value options(*string);                                                              2000472
    820+     //0=(Dft) Same case, 1=ignore case                                                                             2000473
    821+     ignoreCase     Uns(5)     value options(*nopass);                                                              2000474
    822+   End-PR;                                                                                                          2000475
    823+                                                                                                                    2000476
    824+   //Following constants used by json_LookupValue:ignoreCase                                                        2000477
    825+   Dcl-C json_SAME_CASE const(0);                                                                                   2000478
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     22
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    826+   Dcl-C json_IGNORE_CASE const(1);                                                                                 2000479
    827+                                                                                                                    2000480
    828+   //returns numer of element in array or obj                                                                       2000481
    829+   Dcl-PR json_GetLength Int(10) extproc(*CWIDEN : 'jx_getLength'  );                                               2000482
    830+     //Array to count length                                                                                        2000483
    831+     pArray         Pointer    value;                                                                               2000484
    832+   End-PR;                                                                                                          2000485
    833+                                                                                                                    2000486
    834+   //returns the new node                                                                                           2000487
    835+   Dcl-PR json_Merge Pointer extproc(*CWIDEN : 'jx_NodeMerge');                                                     2000488
    836+     //Destination. Retrive from Locate()                                                                           2000489
    837+     pDestNode      Pointer    value;                                                                               2000490
    838+     //Source tree  Retrive from Locate()                                                                           2000491
    839+     pSourceNode    Pointer    value;                                                                               2000492
    840+     //Optional new type                                                                                            2000493
    841+     Type           Uns(5)     value options(*nopass);                                                              2000494
    842+   End-PR;                                                                                                          2000495
    843+                                                                                                                    2000496
    844+   //Following constants used by json_Merge:Type                                                                    2000497
    845+   Dcl-C json_DONTREPLACE const(0);                                                                                 2000498
    846+   Dcl-C json_REPLACE const(1);                                                                                     2000499
    847+                                                                                                                    2000500
    848+   //returns the new node                                                                                           2000501
    849+   Dcl-PR json_MergeObjects Pointer extproc(*CWIDEN : 'jx_MergeObjects');                                           2000502
    850+     //Destination. Retrive from Locate()                                                                           2000503
    851+     pDestObj       Pointer    value;                                                                               2000504
    852+     //Source tree  Retrive from Locate()                                                                           2000505
    853+     pSourceObj     Pointer    value;                                                                               2000506
    854+     //JX_DONTREPLACE or json_OBJREPLACE                                                                            2000507
    855+     Type           Uns(5)     value;                                                                               2000508
    856+   End-PR;                                                                                                          2000509
    857+                                                                                                                    2000510
    858+   //returns the source node                                                                                        2000511
    859+   Dcl-PR json_MoveObjectInto Pointer extproc(*CWIDEN : 'jx_NodeMoveInto');                                         2000512
    860+     //Destination. Retrive from Locate()                                                                           2000513
    861+     pDestObj       Pointer    value;                                                                               2000514
    862+     Name           Pointer    value options(*string);                                                              2000515
    863+     //Source tree  Retrive from Locate()                                                                           2000516
    864+     pSourceObj     Pointer    value;                                                                               2000517
    865+   End-PR;                                                                                                          2000518
    866+                                                                                                                    2000519
    867+   Dcl-PR json_Dump  extproc(*CWIDEN : 'jx_Dump');                                                  I               2000520
    868+     //Pointer to tree                                                                                              2000521
    869+     pNode          Pointer    value;                                                               I               2000522
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     23
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    870+   End-PR;                                                                                                          2000523
    871+                                                                                                                    2000524
    872+                                                                                                                    2000525
    873+   Dcl-PR json_CloneFormat  extproc(*CWIDEN : 'jx_CloneFormat');                                    I               2000526
    874+     //Pointer to tree to receive format                                                                            2000527
    875+     pNode          Pointer    value;                                                               I               2000528
    876+     //node ptr or path with right formating                                                                        2000529
    877+     pCloneFrom     Pointer    value options(*string);                                              I               2000530
    878+   End-PR;                                                                                                          2000531
    879+                                                                                                                    2000532
    880+   //**  JSON renderes ***                                                                                          2000533
    881+   Dcl-PR json_WriteJsonStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                I               2000534
    882+     //node. Retrive from Locate()                                                                                  2000535
    883+     pNode          Pointer    value;                                                               I               2000536
    884+     //Name of output stream file                                                                                   2000537
    885+     FileName       Pointer    value options(*string);                                              I               2000538
    886+     //Ccsid of output file                                                                                         2000539
    887+     Ccsid          Int(10)    value;                                                               I               2000540
    888+     Trim           Ind        value;                                                                               2000541
    889+     //Extra options                                                                                                2000542
    890+     Options        Pointer    value options(*string:*nopass);                                      I               2000543
    891+   End-PR;                                                                                                          2000544
    892+                                                                                                                    2000545
    893+   Dcl-PR json_AsJsonText Varchar(32767)                                                                            2000546
    894+                        extproc(*CWIDEN : 'jx_AsJsonText');                                                         2000547
    895+     //node. Retrive from Locate()                                                                                  2000548
    896+     pNode          Pointer    value;                                                                               2000549
    897+   End-PR;                                                                                                          2000550
    898+                                                                                                                    2000551
    899+   Dcl-PR json_AsJsonTextMem Uns(10)                                                                                2000552
    900+                           extproc(*CWIDEN : 'jx_AsJsonTextMem');                                                   2000553
    901+     //node. Retrive from Locate()                                                                                  2000554
    902+     pNode          Pointer    value;                                                                               2000555
    903+     //pointer to any memory buffer                                                                                 2000556
    904+     pBuffer        Pointer    value;                                                                               2000557
    905+     //Max number of bytes in buffer %size()                                                                        2000558
    906+     maxSize        Uns(10)    value options(*nopass);                                                              2000559
    907+   End-PR;                                                                                                          2000560
    908+                                                                                                                    2000561
    909+   //**  XML  renderes ***                                                                                          2000562
    910+   Dcl-PR json_WriteXmlStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                  I               2000563
    911+     //node. Retrive from Locate()                                                                                  2000564
    912+     pNode          Pointer    value;                                                               I               2000565
    913+     //Name of output stream file                                                                                   2000566
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     24
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    914+     FileName       Pointer    value options(*string);                                              I               2000567
    915+     //Ccsid of output file                                                                                         2000568
    916+     Ccsid          Int(10)    value;                                                               I               2000569
    917+     Trim           Ind        value;                                                                               2000570
    918+     //Extra options                                                                                                2000571
    919+     Options        Pointer    value options(*string:*nopass);                                      I               2000572
    920+   End-PR;                                                                                                          2000573
    921+                                                                                                                    2000574
    922+   Dcl-PR json_AsXmlText Varchar(32767) extproc(*CWIDEN : 'jx_AsXmlText');                                          2000575
    923+     //node. Retrive from Locate()                                                                                  2000576
    924+     pNode          Pointer    value;                                                                               2000577
    925+   End-PR;                                                                                                          2000578
    926+                                                                                                                    2000579
    927+   Dcl-PR json_AsXmlTextMem Uns(10) extproc(*CWIDEN : 'jx_AsXmlTextMem');                                           2000580
    928+     //node. Retrive from Locate()                                                                                  2000581
    929+     pNode          Pointer    value;                                                                               2000582
    930+     //pointer to any memory buffer                                                                                 2000583
    931+     pBuffer        Pointer    value;                                                                               2000584
    932+   End-PR;                                                                                                          2000585
    933+                                                                                                                    2000586
    934+   // Return a streamer object to be used in own serialisers                                                        2000587
    935+   Dcl-PR json_Stream pointer extproc(*CWIDEN : 'jx_Stream');                                                       2000588
    936+     //node. Retrive from Locate()                                                                                  2000589
    937+     pNode          Pointer    value;                                                                               2000590
    938+   End-PR;                                                                                                          2000591
    939+                                                                                                                    2000592
    940+   //**  CSV  renderes ***                                                                                          2000593
    941+   Dcl-PR json_WriteCsvStmf  extproc(*CWIDEN : 'jx_WriteCsvStmf');                                  I               2000594
    942+     //node. Retrive from Locate()                                                                                  2000595
    943+     pNode          Pointer    value;                                                               I               2000596
    944+     //Name of output stream file                                                                                   2000597
    945+     FileName       Pointer    value options(*string);                                              I               2000598
    946+     //Ccsid of output file                                                                                         2000599
    947+     Ccsid          Int(10)    value;                                                               I               2000600
    948+     //*ON=Remove inter blanks                                                                                      2000601
    949+     Trim           Ind        value;                                                                               2000602
    950+     //Options: ';.' for separator and dec                                                                          2000603
    951+     Options        Pointer    value options(*string:*nopass);                                      I               2000604
    952+   End-PR;                                                                                                          2000605
    953+                                                                                                                    2000606
    954+                                                                                                                    2000607
    955+   Dcl-DS json_DelimiterDS  based(prototype_only) qualified;                                                        2000608
    956+     Slash          Char(1);                                                                                        2000609
    957+     BackSlash      Char(1);                                                                                        2000610
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     25
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    958+     Masterspace    Char(1);                                                                                        2000611
    959+     BraBeg         Char(1);                                                                                        2000612
    960+     BraEnd         Char(1);                                                                                        2000613
    961+     Blank          Char(1);                                                                                        2000614
    962+     Dot            Char(1);                                                                                        2000615
    963+     CurBeg         Char(1);                                                                                        2000616
    964+     CurEnd         Char(1);                                                                                        2000617
    965+     Apos           Char(1);                                                                                        2000618
    966+     Quot           Char(1);                                                                                        2000619
    967+   End-DS;                                                                                                          2000620
    968+                                                                                                                    2000621
    969+   //Iterators: First use the set the use forEach                                                                   2000622
    970+   Dcl-DS json_Iterator  based(prototype_only) qualified;                                                           2000623
    971+     root           Pointer;                                                                                        2000624
    972+     this           Pointer;                                                                                        2000625
    973+     isList         Ind;                                                                                            2000626
    974+     isFirst        Ind;                                                                                            2000627
    975+     isLast         Ind;                                                                                            2000628
    976+     isRecursive    Ind;                                                                                            2000629
    977+     comma          Varchar(1);                                                                                     2000630
    978+     count          Int(10);                                                                                        2000631
    979+     length         Int(10);                                                                                        2000632
    980+     size           Int(10);                                                                                        2000633
    981+     //Pointer to temp array of elms                                                                                2000634
    982+     listArr        Pointer;                                                                                        2000635
    983+     //Set  this to *ON to teminate loop                                                                            2000636
    984+     break          Ind;                                                                                            2000637
    985+     filler         Char(64);                                                                                       2000638
    986+   End-DS;                                                                                                          2000639
    987+                                                                                                                    2000640
    988+   Dcl-PR json_setIterator  likeds( json_Iterator)                                                                  2000641
    989+                          extproc(*CWIDEN : 'jx_SetIterator');                                                      2000642
    990+     //node. Retrive from Locate()                                                                                  2000643
    991+     pNode          Pointer    value;                                                                               2000644
    992+     //Optional - path to node                                                                                      2000645
    993+     path           Pointer    value options(*string:*nopass);                                                      2000646
    994+   End-PR;                                                                                                          2000647
    995+                                                                                                                    2000648
    996+   Dcl-PR json_setRecursiveIterator  likeds( json_Iterator)                                                         2000649
    997+                                   extproc(*CWIDEN :                                                                2000650
    998+                                   'jx_SetRecursiveIterator');                                                      2000651
    999+     //node. Retrive from Locate()                                                                                  2000652
   1000+     pNode          Pointer    value;                                                                               2000653
   1001+     //Optional - path to node                                                                                      2000654
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     26
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1002+     path           Pointer    value options(*string:*nopass);                                                      2000655
   1003+   End-PR;                                                                                                          2000656
   1004+                                                                                                                    2000657
   1005+   //Iterator Structure                                                                                             2000658
   1006+   Dcl-PR json_forEach Ind extproc(*CWIDEN : 'jx_ForEach');                                                         2000659
   1007+     iterator                  likeds( json_Iterator);                                                              2000660
   1008+   End-PR;                                                                                                          2000661
   1009+                                                                                                                    2000662
   1010+   //For XML attributes                                                                                             2000663
   1011+   Dcl-PR json_GetNodeAttrValue Varchar(32767)                                                      I               2000664
   1012+                              extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                           2000665
   1013+     //Pointer to exsiting element                                                                                  2000666
   1014+     pNode          Pointer    value;                                                                               2000667
   1015+     //Attribute Name                                                                                               2000668
   1016+     AttrName       Pointer    value options(*string);                                              I               2000669
   1017+     //If not found - default value                                                                                 2000670
   1018+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000671
   1019+   End-PR;                                                                                                          2000672
   1020+                                                                                                                    2000673
   1021+   Dcl-PR json_SetNodeAttrValue extproc(*CWIDEN : 'jx_SetNodeAttrValue');                                           2000674
   1022+     //Pointer to exsiting element                                                                                  2000675
   1023+     pNode          Pointer    value;                                                                               2000676
   1024+     //Attribute name                                                                                               2000677
   1025+     AttrName       Pointer    value options(*string);                                                              2000678
   1026+     //New value                                                                                                    2000679
   1027+     Value          Pointer    value options(*string);                                                              2000680
   1028+   End-PR;                                                                                                          2000681
   1029+                                                                                                                    2000682
   1030+   Dcl-PR json_GetAttrValue Varchar(32767)                                                          I               2000683
   1031+                          extproc(*CWIDEN : 'jx_GetAttrValueVC');                                                   2000684
   1032+     //Pointer Attribute                                                                                            2000685
   1033+     pAttr          Pointer    value;                                                               I               2000686
   1034+     //If not found - default value                                                                                 2000687
   1035+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000688
   1036+   End-PR;                                                                                                          2000689
   1037+                                                                                                                    2000690
   1038+   Dcl-PR json_SetAttrValue extproc(*CWIDEN : 'jx_SetAttrValue');                                                   2000691
   1039+     //Pointer Attribute                                                                                            2000692
   1040+     pAttr          Pointer    value;                                                               I               2000693
   1041+     //New value                                                                                                    2000694
   1042+     Value          Pointer    value options(*string);                                                              2000695
   1043+   End-PR;                                                                                                          2000696
   1044+                                                                                                                    2000697
   1045+   //Returns pointer to attribute list                                                                              2000698
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     27
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1046+   Dcl-PR json_GetAttrFirst Pointer extproc(*CWIDEN : 'jx_GetAttrFirst');                           I               2000699
   1047+     //Pointer to element                                                                                           2000700
   1048+     pElem          Pointer    value;                                                               I               2000701
   1049+   End-PR;                                                                                                          2000702
   1050+                                                                                                                    2000703
   1051+   //Returns pointer to attribute list                                                                              2000704
   1052+   Dcl-PR json_GetAttrNext Pointer extproc(*CWIDEN : 'jx_GetAttrNext');                             I               2000705
   1053+     //Pointer to attribute list                                                                                    2000706
   1054+     pAttr          Pointer    value;                                                               I               2000707
   1055+   End-PR;                                                                                                          2000708
   1056+                                                                                                                    2000709
   1057+   Dcl-PR json_GetAttrName Varchar(32767)                                                                           2000710
   1058+                         extproc(*CWIDEN : 'jx_GetAttrNameVC');                                                     2000711
   1059+     //Pointer to attribute list                                                                                    2000712
   1060+     pAttr          Pointer    value;                                                               I               2000713
   1061+   End-PR;                                                                                                          2000714
   1062+                                                                                                                    2000715
   1063+ // Clear the contents of an array or object / delete all children                                                  2000716
   1064+   Dcl-PR json_Clear  extproc(*CWIDEN : 'jx_Clear');                                                I               2000717
   1065+     pNode          Pointer    value; //Pointer to tree node                                        I               2000718
   1066+   End-PR;                                                                                                          2000719
   1067+                                                                                                                    2000720
   1068+ // Close all nodes in this tree - also parent and siblings                                                         2000721
   1069+   Dcl-PR json_Close  extproc(*CWIDEN : 'jx_Close');                                                I               2000722
   1070+     //Pointer to tree node                                                                                         2000723
   1071+     pNode          Pointer  ;                                                                      I               2000724
   1072+   End-PR;                                                                                                          2000725
   1073+ // Detect if you have a memry leak: call this when you have closed everything at i will return                     2000726
   1074+   Dcl-PR json_MemLeak Ind extproc(*CWIDEN : 'jx_MemLeak');                                         I               2000727
   1075+   End-PR;                                                                                                          2000728
   1076+                                                                                                                    2000729
   1077+ // Print memory report                                                                                             2000730
   1078+   Dcl-PR json_MemStat  extproc(*CWIDEN : 'jx_MemStat');                                            I               2000731
   1079+   End-PR;                                                                                                          2000732
   1080+                                                                                                                    2000733
   1081+ // retune number of bytest used                                                                                    2000734
   1082+   Dcl-PR json_MemUse Uns(20) extproc(*CWIDEN : 'jx_MemUse');                                       I               2000735
   1083+   End-PR;                                                                                                          2000736
   1084+                                                                                                                    2000737
   1085+ // Return a memory segment pointer, and build a scope where JSON/XML will be created                               2000738
   1086+   Dcl-PR json_SegmentSelectNo Pointer                                                              I               2000739
   1087+                             extproc(*CWIDEN : 'jx_SegmentSelectNo');                                               2000740
   1088+     SegmentIndex   Int(10)    value;                                                                               2000741
   1089+   End-PR;                                                                                                          2000742
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     28
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1090+                                                                                                                    2000743
   1091+ //  Delete the segment and all JSON/XML nodes build while segment scope was active                                 2000744
   1092+   Dcl-PR json_SegmentDispose  extproc(*CWIDEN : 'jx_SegmentDispose');                              I               2000745
   1093+     segmentPtr     Pointer    value;                                                                               2000746
   1094+   End-PR;                                                                                                          2000747
   1095+                                                                                                                    2000748
   1096+ // Maintain at list of index numbers to database CLOB/BLOB fields since pointers can not be sh                     2000749
   1097+   //Returns *ON if found                                                                                           2000750
   1098+   Dcl-PR json_mapIx Ind extproc(*CWIDEN:'jx_MapIx' );                                              I               2000751
   1099+     //pointer to node pointer                                                                                      2000752
   1100+     ppNode         Pointer;                                                                        I               2000753
   1101+     //index of pointer                                                                                             2000754
   1102+     Index          Uns(10)    value;                                                               I               2000755
   1103+   End-PR;                                                                                                          2000756
   1104+                                                                                                                    2000757
   1105+   //------------------------------------------------------------------------                                       2000758
   1106+   //SQL interface:                                                                                                 2000759
   1107+   //Note: When SQL functions returns *NULL, then use  the json_Message() to re                                     2000760
   1108+   //------------------------------------------------------------------------                                       2000761
   1109+                                                                                                                    2000762
   1110+ // If options need - then it has to be first call made.                                                            2000763
   1111+ // NOTE: If a pConnection pointer is provided, it will be updated with the conection                               2000764
   1112+   Dcl-PR json_sqlSetOptions  extproc(*CWIDEN: 'jx_sqlSetOptions');                                 I               2000765
   1113+     //json object with options ( see sample)                                                                       2000766
   1114+     parms          Pointer    value options(*string:*nopass);                                      I               2000767
   1115+   End-PR;                                                                                                          2000768
   1116+                                                                                                                    2000769
   1117+ // returns a object node with one resulting row for the SQL statment                                               2000770
   1118+   //Returns one SQL row as jx Obejct                                                                               2000771
   1119+   Dcl-PR json_sqlResultRow Pointer extproc(*CWIDEN: 'jx_sqlResultRow');                            I               2000772
   1120+     //SQL statement to run                                                                                         2000773
   1121+     sqlStmt        Pointer    value options(*string);                                              I               2000774
   1122+     //json object template                                                                                         2000775
   1123+     parms          Pointer    value options(*string:*nopass);                                      I               2000776
   1124+   End-PR;                                                                                                          2000777
   1125+                                                                                                                    2000778
   1126+ // returns an array (or object with array) of resulting rows for the SQL statment                                  2000779
   1127+   //Returns SQL rows as jx Obejct                                                                                  2000780
   1128+   Dcl-PR json_sqlResultSet Pointer extproc(*CWIDEN: 'jx_sqlResultSet');                            I               2000781
   1129+     //SQL statement to run                                                                                         2000782
   1130+     sqlStmt        Pointer    value options(*string);                                              I               2000783
   1131+     //From row; 1=First                                                                                            2000784
   1132+     start          Int(10)    value options(*nopass);                                              I               2000785
   1133+     //max number of rows; json_ALLROWS=all                                                                         2000786
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     29
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1134+     limit          Int(10)    value options(*nopass);                                              I               2000787
   1135+     //resultset format:                                                                                            2000788
   1136+     format         Int(10)    value options(*nopass);                                              I               2000789
   1137+     //json object template                                                                                         2000790
   1138+     parms          Pointer    value options(*string:*nopass);                                      I               2000791
   1139+   End-PR;                                                                                                          2000792
   1140+                                                                                                                    2000793
   1141+                                                                                                                    2000794
   1142+   Dcl-C json_ALLROWS const(-1);                                                                                    2000795
   1143+                                                                                                                    2000796
   1144+   //Following constants used by json_sqlResultSet:format                                                           2000797
   1145+   //+ An array with each row as an object                                                                          2000798
   1146+   Dcl-C json_ROWARRAY const(0);                                                                                    2000799
   1147+   //+ Metaobject: rows, fields                                                                                     2000800
   1148+   Dcl-C json_META    const(1);                                                                                     2000801
   1149+   //+ Columns info                                                                                                 2000802
   1150+   Dcl-C json_FIELDS  const(2);                                                                                     2000803
   1151+   //+ Count all rows in the resultset                                                                              2000804
   1152+   // ( Pricy so awoid it !! )                                                                                      2000805
   1153+   Dcl-C json_TOTALROWS const(4);                                                                                   2000806
   1154+   //+ Uppercase column names                                                                                       2000807
   1155+   Dcl-C json_UPPERCASE const(8);                                                                                   2000808
   1156+                                                                                                                    2000809
   1157+   //+ Appoximate number of rows..                                                                                  2000810
   1158+   //  ( unpresise but cheap !! prefered  )                                                                         2000811
   1159+   Dcl-C json_APPROXIMATE_TOTALROWS const(16);                                                                      2000812
   1160+                                                                                                                    2000813
   1161+                                                                                                                    2000814
   1162+                                                                                                                    2000815
   1163+ // SQL cursor processing                                                                                           2000816
   1164+   //Returns handle to sql statement                                                                                2000817
   1165+   Dcl-PR json_sqlOpen Pointer extproc(*CWIDEN:'jx_sqlOpen'  );                                     I               2000818
   1166+     //SQL statement to run                                                                                         2000819
   1167+     sqlStmt        Pointer    value options(*string);                                              I               2000820
   1168+     //json object template                                                                                         2000821
   1169+     parms          Pointer    value options(*string:*nopass);                                      I               2000822
   1170+   End-PR;                                                                                                          2000823
   1171+                                                                                                                    2000824
   1172+ // Fetch next from from that open sql handle, starting from rowNumer. 1=First row                                  2000825
   1173+   //Returns a row object (or *NULL if EOF)                                                                         2000826
   1174+   Dcl-PR json_sqlFetchRelative Pointer                                                             I               2000827
   1175+                              extproc(*CWIDEN: 'jx_sqlFetchRelative');                                              2000828
   1176+     //sql statement handle ( from sqlOpen)                                                                         2000829
   1177+     pSqlHndl       Pointer    value;                                                               I               2000830
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     30
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1178+     //row from where to start 1=First                                                                              2000831
   1179+     fromRow        Int(10)    value;                                                               I               2000832
   1180+   End-PR;                                                                                                          2000833
   1181+                                                                                                                    2000834
   1182+ // Fetch next from from that open sql handle                                                                       2000835
   1183+   //Returns a row object (or *NULL if EOF)                                                                         2000836
   1184+   Dcl-PR json_sqlFetchNext Pointer extproc(*CWIDEN:'jx_sqlFetchNext');                             I               2000837
   1185+     //sql statement handle ( from sqlOpen)                                                                         2000838
   1186+     pSqlHndl       Pointer    value;                                                               I               2000839
   1187+   End-PR;                                                                                                          2000840
   1188+                                                                                                                    2000841
   1189+ // Number of columns in result set ( -1 if error)                                                                  2000842
   1190+   //Returns number of columns                                                                                      2000843
   1191+   Dcl-PR json_sqlColumns Int(10) extproc(*CWIDEN:'jx_sqlColumns');                                 I               2000844
   1192+     //sql statement handle ( from sqlOpen)                                                                         2000845
   1193+     pSqlHndl       Pointer    value;                                                               I               2000846
   1194+   End-PR;                                                                                                          2000847
   1195+                                                                                                                    2000848
   1196+ // Number of rows  in result set ( -1 if error)                                                                    2000849
   1197+ // Note: This will run a hidden "select count(*)" which might be a little pricy                                    2000850
   1198+   //Returns number of rows                                                                                         2000851
   1199+   Dcl-PR json_sqlRows Int(10) extproc(*CWIDEN:'jx_sqlRows');                                       I               2000852
   1200+     //sql statement handle ( from sqlOpen)                                                                         2000853
   1201+     pSqlHndl       Pointer    value;                                                               I               2000854
   1202+   End-PR;                                                                                                          2000855
   1203+                                                                                                                    2000856
   1204+ // Always colse the cursor after use, to release resources                                                         2000857
   1205+   Dcl-PR json_sqlClose  extproc(*CWIDEN:'jx_sqlClose');                                            I               2000858
   1206+     //sql statement handle ( from sqlOpen)                                                                         2000859
   1207+     pSqlHndl       Pointer;                                                                        I               2000860
   1208+   End-PR;                                                                                                          2000861
   1209+                                                                                                                    2000862
   1210+ // Execute any SQL statement not involving a cursor                                                                2000863
   1211+   //Returns *ON if error                                                                                           2000864
   1212+   Dcl-PR json_sqlExec Ind extproc(*CWIDEN:'jx_sqlExec'  );                                         I               2000865
   1213+     //SQL statement to run (template)                                                                              2000866
   1214+     sqlStmt        Pointer    value options(*string);                                              I               2000867
   1215+     //json object template data                                                                                    2000868
   1216+     parms          Pointer    value options(*string:*nopass);                                      I               2000869
   1217+   End-PR;                                                                                                          2000870
   1218+                                                                                                                    2000871
   1219+ // Execute an update table where the row is defined as a json object                                               2000872
   1220+   //Returns *ON if error                                                                                           2000873
   1221+   Dcl-PR json_sqlUpdate Ind extproc(*CWIDEN:'jx_sqlUpdate');                                       I               2000874
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     31
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1222+     //table name                                                                                                   2000875
   1223+     table          Pointer    value options(*string);                                              I               2000876
   1224+     //json object: æa:123,b:"value"å                                                                               2000877
   1225+     row            Pointer    value options(*string);                                              I               2000878
   1226+     //where clause : 'where myKey=Åkey'                                                                            2000879
   1227+     where          Pointer    value options(*string:*nopass);                                      I               2000880
   1228+     //where parameters: æ key:777å                                                                                 2000881
   1229+     whereParms     Pointer    value options(*string:*nopass);                                      I               2000882
   1230+   End-PR;                                                                                                          2000883
   1231+                                                                                                                    2000884
   1232+   //Returns *ON if error                                                                                           2000885
   1233+   Dcl-PR json_sqlInsert Ind extproc(*CWIDEN:'jx_sqlInsert');                                       I               2000886
   1234+     //table name                                                                                                   2000887
   1235+     table          Pointer    value options(*string);                                              I               2000888
   1236+     //json object: æa:123,b:"value"å                                                                               2000889
   1237+     row            Pointer    value options(*string);                                              I               2000890
   1238+     //extra parms                                                                                                  2000891
   1239+     parms          Pointer    value options(*string:*nopass);                                      I               2000892
   1240+   End-PR;                                                                                                          2000893
   1241+                                                                                                                    2000894
   1242+   //Returns *ON if error                                                                                           2000895
   1243+   Dcl-PR json_sqlUpsert Ind extproc(*CWIDEN:'jx_sqlUpsert');                                       I               2000896
   1244+     //table name                                                                                                   2000897
   1245+     table          Pointer    value options(*string);                                              I               2000898
   1246+     //json object: æa:123,b:"value"å                                                                               2000899
   1247+     row            Pointer    value options(*string);                                              I               2000900
   1248+     //where clause : 'where myKey=Åkey'                                                                            2000901
   1249+     where          Pointer    value options(*string:*nopass);                                      I               2000902
   1250+     //where parameters: æ key:777å                                                                                 2000903
   1251+     whereParms     Pointer    value options(*string:*nopass);                                      I               2000904
   1252+   End-PR;                                                                                                          2000905
   1253+                                                                                                                    2000906
   1254+   //Returns id of last insert                                                                                      2000907
   1255+   Dcl-PR json_sqlGetInsertId Int(10) extproc(*CWIDEN:'jx_sqlGetInsertId');                         I               2000908
   1256+   End-PR;                                                                                                          2000909
   1257+                                                                                                                    2000910
   1258+   //Returns array of column info                                                                                   2000911
   1259+   Dcl-PR json_sqlGetMeta Pointer extproc(*CWIDEN:'jx_sqlGetMeta');                                 I               2000912
   1260+     sqlstmt        Pointer    value options(*string);                                                              2000913
   1261+   End-PR;                                                                                                          2000914
   1262+                                                                                                                    2000915
   1263+ // Return pointer to database connection. No options => will be default local database                             2000916
   1264+   Dcl-PR json_sqlConnect Pointer extproc(*CWIDEN: 'jx_sqlConnect');                                I               2000917
   1265+     //json object or string with options                                                                           2000918
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     32
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1266+     parms          Pointer    value options(*string:*nopass);                                      I               2000919
   1267+   End-PR;                                                                                                          2000920
   1268+                                                                                                                    2000921
   1269+ // Return pointer to database connection. No options => will be default local database                             2000922
   1270+   Dcl-PR json_sqlDisconnect  extproc(*CWIDEN: 'jx_sqlDisconnect');                                 I               2000923
   1271+   End-PR;                                                                                                          2000924
   1272+                                                                                                                    2000925
   1273+ // Return sql code for previous statement                                                                          2000926
   1274+   Dcl-PR json_sqlCode Int(10) extproc(*CWIDEN: 'jx_sqlCode');                                      I               2000927
   1275+   End-PR;                                                                                                          2000928
   1276+                                                                                                                    2000929
   1277+ //Returns a JSON object from a REST call                                                                           2000930
   1278+   Dcl-PR json_httpRequest Pointer extproc(*CWIDEN:'jx_httpRequest');                               I               2000931
   1279+     //Full URL to the resource                                                                                     2000932
   1280+     url            Pointer    value options(*string);                                                              2000933
   1281+     //json object or string                                                                                        2000934
   1282+     pReqNode       Pointer    value options(*string:*nopass);                                                      2000935
   1283+     //extra CURL options                                                                                           2000936
   1284+     options        Pointer    value options(*string:*nopass);                                                      2000937
   1285+   End-PR;                                                                                                          2000938
   1286+                                                                                                                    2000939
   1287+ // when the dataarea SQLTRACE is set, your SQL statements                                                          2000940
   1288+ // are logged into SQLTRACE table.                                                                                 2000941
   1289+ // you can supply an extr eye-catch wariable :trcid                                                                2000942
   1290+   Dcl-PR json_traceSetId  extproc(*CWIDEN : 'jx_traceSetId');                                                      2000943
   1291+     traceId        Int(20)    value; //Ccsid of inpur file                                         I               2000944
   1292+   End-PR;                                                                                                          2000945
   1293+                                                                                                                    2000946
   1294+ // -------------------------------------------------------------------------------------------                     2000947
   1295+ // Depricated and renamed functions :                                                                              2000948
   1296+ // -------------------------------------------------------------------------------------------                     2000949
   1297+ // Depricated - use  json_GetValueStr                                                                              2000950
   1298+   Dcl-PR json_GetValue Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                          I               2000951
   1299+     //Pointer to node                                                                                              2000952
   1300+     pNode          Pointer    value;                                                               I               2000953
   1301+     //If not found - default value                                                                                 2000954
   1302+     Expression     Pointer    value options(*string:*nopass);                                      I               2000955
   1303+     //If not found - default value                                                                                 2000956
   1304+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2000957
   1305+   End-PR;                                                                                                          2000958
   1306+                                                                                                                    2000959
   1307+ // Depricated - use  json_NodeCopy                                                                                 2000960
   1308+   Dcl-PR json_Copy extproc(*CWIDEN : 'jx_NodeCopy');                                                               2000961
   1309+     //element. Retrive from Locate()                                                                               2000962
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     33
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1310+     pRootNode      Pointer    value;                                                                               2000963
   1311+     //element. Retrive from Locate()                                                                               2000964
   1312+     pNewChild      Pointer    value;                                                                               2000965
   1313+     //Reference location to where it arrive                                                                        2000966
   1314+     RefLocation    Int(10)    value;                                                                               2000967
   1315+   End-PR;                                                                                                          2000968
   1316+                                                                                                                    2000969
   1317+   Dcl-PR json_ElementCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                        2000970
   1318+     //element. Retrive from Locate()                                                                               2000971
   1319+     pRootNode      Pointer    value;                                                                               2000972
   1320+     //element. Retrive from Locate()                                                                               2000973
   1321+     pNewChild      Pointer    value;                                                                               2000974
   1322+     //Reference location to where it arrive                                                                        2000975
   1323+     RefLocation    Int(10)    value;                                                                               2000976
   1324+   End-PR;                                                                                                          2000977
   1325+                                                                                                                    2000978
   1326+ // Depricated - use  json_NodeDelete                                                                               2000979
   1327+   Dcl-PR json_Delete extproc(*CWIDEN : 'jx_NodeDelete');                                                           2000980
   1328+     //element. Retrive from Locate()                                                                               2000981
   1329+     pRootNode      Pointer    value;                                                                               2000982
   1330+   End-PR;                                                                                                          2000983
   1331+                                                                                                                    2000984
   1332+ // Depricated - use  json_NodeDelete                                                                               2000985
   1333+   Dcl-PR json_ElementDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                    2000986
   1334+     //element. Retrive from Locate()                                                                               2000987
   1335+     pRootNode      Pointer    value;                                                                               2000988
   1336+   End-PR;                                                                                                          2000989
   1337+                                                                                                                    2000990
   1338+ // Depricated - use  json_AsJsonText                                                                               2000991
   1339+   Dcl-PR json_AsText Varchar(32767) extproc(*CWIDEN : 'jx_AsJsonText');                                            2000992
   1340+     //element. Retrive from Locate()                                                                               2000993
   1341+     pNode          Pointer    value;                                                                               2000994
   1342+   End-PR;                                                                                                          2000995
   1343+                                                                                                                    2000996
   1344+                                                                                                                    2000997
   1345+ // json_XpathValue   is depricated and replaced by: json_GetStr                                                    2000998
   1346+   Dcl-PR json_XpathValue Varchar(32767)                                                                            2000999
   1347+                        extproc(*CWIDEN : 'jx_GetValueVC');                                                         2001000
   1348+     //Pointer to tree                                                                                              2001001
   1349+     pNode          Pointer    value;                                                                               2001002
   1350+     //Locations expression to node                                                                                 2001003
   1351+     Expression     Pointer    value options(*string);                                                              2001004
   1352+     //If not found - default value                                                                                 2001005
   1353+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      2001006
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     34
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1354+   End-PR;                                                                                                          2001007
   1355+                                                                                                                    2001008
   1356+ // json_XpathValueNum   is depricated and replaced by: json_GetNum                                                 2001009
   1357+   Dcl-PR json_XpathValueNum Packed(30:15)                                                                          2001010
   1358+                           extproc(*CWIDEN : 'jx_GetValueNum');                                                     2001011
   1359+     //Pointer to tree                                                                                              2001012
   1360+     pJsonCom       Pointer    value;                                                                               2001013
   1361+     //X-path locations to node or attributes                                                                       2001014
   1362+     Node           Pointer    value options(*string);                                                              2001015
   1363+     //If not found - default value                                                                                 2001016
   1364+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           2001017
   1365+   End-PR;                                                                                                          2001018
   1366+                                                                                                                    2001019
   1367+ // Use - json_NodeType                                                                                             2001020
   1368+   Dcl-PR json_ElementType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                              I               2001021
   1369+     //Pointer to tree to receive format                                                                            2001022
   1370+     pNode          Pointer    value;                                                               I               2001023
   1371+   End-PR;                                                                                                          2001024
   1372+                                                                                                                    2001025
   1373+ // Use json_NodeAdd                                                                                                2001026
   1374+   //returns the new element                                                                                        2001027
   1375+   Dcl-PR json_ElementAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                  2001028
   1376+     //element. Retrive from Locate()                                                                               2001029
   1377+     pRootNode      Pointer    value;                                                                               2001030
   1378+     //Reference location to where it arrive                                                                        2001031
   1379+     RefLocation    Int(10)    value;                                                                               2001032
   1380+     //Name of element                                                                                              2001033
   1381+     Name           Pointer    value options(*string);                                              I               2001034
   1382+     //Value of element                                                                                             2001035
   1383+     Value          Pointer    value options(*string);                                              I               2001036
   1384+   End-PR;                                                                                                          2001037
   1385+                                                                                                                    2001038
   1386+ // Use json_GetNext                                                                                                2001039
   1387+   //Returns pointer to next sibling (elem)                                                                         2001040
   1388+   Dcl-PR json_GetElemNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                             I               2001041
   1389+     //Pointer to current element (elem)                                                                            2001042
   1390+     pElem          Pointer    value  ;                                                             I               2001043
   1391+   End-PR;                                                                                                          2001044
   1392+                                                                                                                    2001045
   1393+ // use json_GetChild                                                                                               2001046
   1394+   //Returns pointer to next child (elem)                                                                           2001047
   1395+   Dcl-PR json_GetElemChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                           I               2001048
   1396+     //Pointer to current element (elem)                                                                            2001049
   1397+     pElem          Pointer    value;                                                               I               2001050
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     35
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1398+   End-PR;                                                                                                          2001051
   1399+                                                                                                                    2001052
   1400+                                                                                                                    2001053
   1401+ // use get json_GetName                                                                                            2001054
   1402+   Dcl-PR json_getElemName Varchar(32767)                                                           I               2001055
   1403+                         extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                     2001056
   1404+     //Pointer to node                                                                                              2001057
   1405+     pNode          Pointer    value;                                                               I               2001058
   1406+   End-PR;                                                                                                          2001059
   1407+                                                                                                                    2001060
   1408+ // use xml_GetValueStr                                                                                             2001061
   1409+   Dcl-PR json_GetElemValue Varchar(32767)                                                          I               2001062
   1410+                          extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                   2001063
   1411+     //Pointer to element                                                                                           2001064
   1412+     pElem          Pointer    value;                                                               I               2001065
   1413+     //If not found - default value                                                                                 2001066
   1414+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2001067
   1415+   End-PR;                                                                                                          2001068
   1416+                                                                                                                    2001069
   1417+  // use json_GetAttrValue                                                                                          2001070
   1418+   Dcl-PR json_GetAttr Varchar(32767)                                                               I               2001071
   1419+                     extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                                    2001072
   1420+     //Pointer to element                                                                                           2001073
   1421+     pNode          Pointer    value;                                                               I               2001074
   1422+     //Attribute Name                                                                                               2001075
   1423+     AttrName       Pointer    value options(*string);                                              I               2001076
   1424+     //If not found - default value                                                                                 2001077
   1425+     Defaultvalue   Pointer    value options(*string:*nopass);                                      I               2001078
   1426+   End-PR;                                                                                                          2001079
   1427+                                                                                                                    2001080
   1428+ // has no effect any longer                                                                                        2001081
   1429+   //Set input and output CCSID                                                                                     2001082
   1430+   Dcl-PR json_setCcsid  extproc(*CWIDEN : 'jx_SetCcsid');                                                          2001083
   1431+     //Ccsid of inpur file                                                                                          2001084
   1432+     inputCCSID     Int(10)    value;                                                               I               2001085
   1433+     //Ccsid of output file                                                                                         2001086
   1434+     outputCCSID    Int(10)    value;                                                               I               2001087
   1435+   End-PR;                                                                                                          2001088
   1436+                                                                                                                    2001089
   1437+ // depricated - use setNum                                                                                         2001090
   1438+   Dcl-PR json_SetDec Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  2001091
   1439+     //Pointer to json_ tree                                                                                        2001092
   1440+     pNode          Pointer    value;                                                                               2001093
   1441+     //X-path locations to node or attributes                                                                       2001094
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     36
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1442+     Expresion      Pointer    value options(*string);                                                              2001095
   1443+     //New value to set / pointer to object                                                                         2001096
   1444+     Value          Packed(30:15) value;                                                                            2001097
   1445+   End-PR;                                                                                                          2001098
   1446+                                                                                                                    2001099
   1447+ // Depricated in both JSON and XML - use  json_WriteJsonStmf /   json_WriteXmlStmf                                 2001100
   1448+ /if not defined(JSONXML_DEPRICATED)                                                                                2001101
   1449+ /define  JSONXML_DEPRICATED                                                                                        2001102
   1450+   Dcl-PR json_WriteStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                    I               2001103
   1451+     //element. Retrive from Locate()                                                                               2001104
   1452+     pNode          Pointer    value;                                                               I               2001105
   1453+     //Name of output stream file                                                                                   2001106
   1454+     FileName       Pointer    value options(*string);                                              I               2001107
   1455+     //Ccsid of output file                                                                                         2001108
   1456+     Ccsid          Int(10)    value;                                                               I               2001109
   1457+     Trim           Ind        value options(*nopass);                                                              2001110
   1458+   End-PR;                                                                                                          2001111
   1459+                                                                                                                    2001112
   1460+   Dcl-PR xml_WriteStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                      I               2001113
   1461+     //element. Retrive from Locate()                                                                               2001114
   1462+     pNode          Pointer    value;                                                               I               2001115
   1463+     //Name of output stream file                                                                                   2001116
   1464+     FileName       Pointer    value options(*string);                                              I               2001117
   1465+     //Ccsid of output file                                                                                         2001118
   1466+     Ccsid          Int(10)    value;                                                               I               2001119
   1467+     Trim           Ind        value options(*nopass);                                                              2001120
   1468+   End-PR;                                                                                                          2001121
   1469+ /endif                                                                                                             2001122
   1470                                                                                                                      000015
   1471    // -----------------------------------------------------------------------------                                  000016
   1472    // Main                                                                                                           000017
   1473    // -----------------------------------------------------------------------------                                  000018
   1474    dcl-proc main;                                                                                                    000019
   1475                                                                                                                      000020
   1476        dcl-ds config likeds(IL_CONFIG);                                                                              000021
   1477                                                                                                                      000022
   1478        config.port = 44003;                                                                                          000023
   1479        config.host = '*ANY';                                                                                         000024
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     37
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1480                                                                                                                      000025
   1481        il_listen (config : %paddr(myservlet));                                                                       000026
   1482                                                                                                                      000027
   1483    end-proc;                                                                                                         000028
   1484    // -----------------------------------------------------------------------------                                  000029
   1485    // Servlet call back implementation                                                                               000030
   1486    // -----------------------------------------------------------------------------                                  000031
   1487    dcl-proc myservlet;                                                                                               000032
   1488                                                                                                                      000033
   1489        dcl-pi *n;                                                                                                    000034
   1490            request  likeds(IL_REQUEST);                                                                              000035
   1491            response likeds(IL_RESPONSE);                                                                             000036
   1492        end-pi;                                                                                                       000037
   1493                                                                                                                      000038
   1494        dcl-s pOutput   pointer;                                                                                      000039
   1495                                                                                                                      000040
   1496        response.contentType = 'application/json';                                                                    000041
   1497                                                                                                                      000042
   1498        pOutput = json_sqlResultSet(' -                                                                               000043
   1499            select * from qiws.QCUSTCDT    -                                                                          000044
   1500        ');                                                                                                           000045
   1501                                                                                                                      000046
   1502        il_responseWriteStream(response : json_stream(pOutput));                                                      000047
   1503                                                                                                                      000048
   1504        json_delete(pOutput);                                                                                         000049
   1505                                                                                                                      000050
   1506    end-proc;                                                                                                         000051
        * * * * *   E N D   O F   S O U R C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     38
           A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
  Msg id  Sv Number Seq     Message text
  * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                             / C o p y   M e m b e r s
 Line   Src  RPG name   <-------- External name -------> CCSID  <- Last change ->
 Number Id              Library    File       Member            Date     Time
     13    1 ILEastic.+ ./.././headers/ILEastic.rpgle      819  10-10-18 16:13:03
    348    2 JSONparse+ /prj/noxdb/./headers/JSONparser+   819  17-09-18 14:18:17
          * * * * *   E N D   O F   / C O P Y   M E M B E R S   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     39
                           C r o s s   R e f e r e n c e
       File and Record References:
          File              Device             References (D=Defined)
            Record
          No references in the source.
       Global Field References:
          Field             Attributes         References (D=Defined M=Modified)
 *RNF7031 IL_ADDROUTE       PROTOTYPE             341D
 *RNF7031 IL_ANY            CONST                 339D
          IL_CONFIG         DS(4166)               53D    265     342    1476
                            TEMPLATE
 *RNF7031   FILLER          A(4096)                56D
 *RNF7031   HOST            A(64)                  54D
                            VARYING(2)
 *RNF7031   PORT            I(10,0)                55D
 *RNF7031 IL_DELETE         CONST                 337D
 *RNF7031 IL_GET            CONST                 335D
 *RNF7031 IL_GETCONTENT     A(524284)             223D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETFILEEXTENSION...
                            A(256)                251D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 IL_GETFILEMIMETYPE...
                            A(256)                237D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTHEADER...
                            A(524284)             206D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTHEADERS...
                            A(524284)             193D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTMETHOD...
                            A(256)                118D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     40
                            VARYING(2)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTPROTOCOL...
                            A(256)                180D
                            VARYING(2)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTQUERYSTRING...
                            A(524284)             167D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTRESOURCE...
                            A(524284)             150D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETREQUESTURL  A(524284)             135D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
 *RNF7031 IL_GETVARCHARVALUE...
                            A(524284)             105D
                            VARYING(4)
                            CCSID(1208)
                            PROTOTYPE
          IL_LISTEN         PROTOTYPE             264D   1481M
 *RNF7031 IL_POST           CONST                 336D
 *RNF7031 IL_PUT            CONST                 338D
          IL_REQUEST        DS(560)                67D    120     137     152
                            TEMPLATE              169     182     195     208
                                                  225    1490
 *RNF7031   COMPLETEHEADER  DS(32)                 78D
 *RNF7031   CONFIG          *(16)                  68D
 *RNF7031   CONTENT         DS(32)                 75D
 *RNF7031   CONTENTLENGTH   U(20,0)                77D
 *RNF7031   CONTENTTYPE     A(256)                 76D
                            VARYING(2)
 *RNF7031   HEADERLIST      *(16)                  79D
 *RNF7031   HEADERS         DS(32)                 74D
 *RNF7031   METHOD          DS(32)                 69D
 *RNF7031   PROTOCOL        DS(32)                 73D
 *RNF7031   QUERYSTRING     DS(32)                 72D
 *RNF7031   RESOURCE        DS(32)                 71D
 *RNF7031   URL             DS(32)                 70D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     41
          IL_RESPONSE       DS(568)                89D    284     304     317
                            TEMPLATE              330    1491
 *RNF7031   CHARSET         A(32)                  94D
                            VARYING(2)
 *RNF7031   CONFIG          *(16)                  90D
 *RNF7031   CONTENTTYPE     A(256)                 93D
                            VARYING(2)
 *RNF7031   STATUS          I(5,0)                 91D
 *RNF7031   STATUSTEXT      A(256)                 92D
                            VARYING(2)
 *RNF7031 IL_RESPONSEWRITE  PROTOTYPE             283D
 *RNF7031 IL_RESPONSEWRITEBIN...
                            PROTOTYPE             303D
          IL_RESPONSEWRITESTREAM...
                            PROTOTYPE             329D   1502M
 *RNF7031 IL_SERVESTATIC    N(1)                  316D
                            PROTOTYPE
          IL_VARCHAR        DS(32)                 45D     69      70      71
                            TEMPLATE               72      73      74      75
                                                   78     107
 *RNF7031   LENGTH          I(10,0)                46D
 *RNF7031   STRING          *(16)                  47D
 *RNF7031 JSON_AFTER_SIBLING...
                            CONST                 718D
 *RNF7031 JSON_ALLOW_PRIMITIVES...
                            CONST                 408D
 *RNF7031 JSON_ALLROWS      CONST                1142D
 *RNF7031 JSON_APPROXIMATE_TOTALROWS...
                            CONST                1159D
 *RNF7031 JSON_ARRAY        CONST                 391D
 *RNF7031 JSON_ARRAYAPPEND  *(16)                 783D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYPUSH    *(16)                 769D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYSLICE   *(16)                 793D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYSORT    *(16)                 805D
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXT   A(32767)              893D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXTMEM...
                            U(10,0)               899D
                            PROTOTYPE
 *RNF7031 JSON_ASTEXT       A(32767)             1339D
                            VARYING(2)
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     42
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXT    A(32767)              922D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXTMEM U(10,0)               927D
                            PROTOTYPE
 *RNF7031 JSON_BEFORE_SIBLING...
                            CONST                 717D
 *RNF7031 JSON_BY_CONTEXT   CONST                 400D
 *RNF7031 JSON_CHILD_LIST   CONST                 428D
 *RNF7031 JSON_CLEAR        PROTOTYPE            1064D
 *RNF7031 JSON_CLONEFORMAT  PROTOTYPE             873D
 *RNF7031 JSON_CLOSE        PROTOTYPE            1069D
 *RNF7031 JSON_COPY         PROTOTYPE            1308D
 *RNF7031 JSON_COPY_CLONE   CONST                 780D
 *RNF7031 JSON_COPYVALUE    *(16)                 694D
                            PROTOTYPE
          JSON_DELETE       PROTOTYPE            1327D   1504M
 *RNF7031 JSON_DELIMITERDS  DS(11)                955D
                            BASED(PROTOTYPE+)
 *RNF7031   APOS            A(1)                  965D
 *RNF7031   BACKSLASH       A(1)                  957D
 *RNF7031   BLANK           A(1)                  961D
 *RNF7031   BRABEG          A(1)                  959D
 *RNF7031   BRAEND          A(1)                  960D
 *RNF7031   CURBEG          A(1)                  963D
 *RNF7031   CUREND          A(1)                  964D
 *RNF7031   DOT             A(1)                  962D
 *RNF7031   MASTERSPACE     A(1)                  958D
 *RNF7031   QUOT            A(1)                  966D
 *RNF7031   SLASH           A(1)                  956D
 *RNF7031 JSON_DELIMITERS   CONST                 384D
 *RNF7031 JSON_DONTREPLACE  CONST                 845D
 *RNF7031 JSON_DUMP         PROTOTYPE             867D
 *RNF7031 JSON_ELEMENTADD   *(16)                1375D
                            PROTOTYPE
 *RNF7031 JSON_ELEMENTCOPY  PROTOTYPE            1317D
 *RNF7031 JSON_ELEMENTDELETE...
                            PROTOTYPE            1333D
 *RNF7031 JSON_ELEMENTTYPE  I(5,0)               1368D
                            PROTOTYPE
 *RNF7031 JSON_ERROR        N(1)                  456D
                            PROTOTYPE
 *RNF7031 JSON_EVAL         CONST                 392D
 *RNF7031 JSON_FIELDS       CONST                1150D
 *RNF7031 JSON_FIRST_CHILD  CONST                 715D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     43
 *RNF7031 JSON_FOREACH      N(1)                 1006D
                            PROTOTYPE
 *RNF7031 JSON_GETATTR      A(32767)             1418D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETATTRFIRST *(16)                1046D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNAME  A(32767)             1057D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNEXT  *(16)                1052D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRVALUE A(32767)             1030D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETCHILD     *(16)                 529D
                            PROTOTYPE
 *RNF7031 JSON_GETDELIMITERS...
                            *(16)                 376D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMCHILD *(16)                1395D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNAME  A(32767)             1402D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNEXT  *(16)                1388D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMVALUE A(32767)             1409D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETILOBVALUE N(1)                  685D
                            PROTOTYPE
 *RNF7031 JSON_GETINT       I(20,0)               674D
                            PROTOTYPE
 *RNF7031 JSON_GETLENGTH    I(10,0)               829D
                            PROTOTYPE
 *RNF7031 JSON_GETNAME      A(32767)              619D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNAMEASPATH...
                            A(32767)              625D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNEXT      *(16)                 523D
                            PROTOTYPE
 *RNF7031 JSON_GETNODEATTRVALUE...
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     44
                            A(32767)             1011D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNUM       P(30,15)              665D
                            PROTOTYPE
 *RNF7031 JSON_GETPARENT    *(16)                 535D
                            PROTOTYPE
 *RNF7031 JSON_GETSTR       A(32767)              642D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETSTRJOIN   A(32767)              652D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETVALUE     A(32767)             1298D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETVALUENUM  P(30,15)              604D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUEPTR  *(16)                 612D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUESTR  A(32767)              596D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_HAS          N(1)                  485D
                            PROTOTYPE
 *RNF7031 JSON_HTTPREQUEST  *(16)                1278D
                            PROTOTYPE
 *RNF7031 JSON_IGNORE_CASE  CONST                 826D
 *RNF7031 JSON_ISNODE       N(1)                  509D
                            PROTOTYPE
 *RNF7031 JSON_ISNULL       N(1)                  501D
                            PROTOTYPE
 *RNF7031 JSON_ISTRUE       N(1)                  493D
                            PROTOTYPE
          JSON_ITERATOR     DS(145)               970D    988     996    1007
                            BASED(PROTOTYPE+)
 *RNF7031   BREAK           N(1)                  984D
 *RNF7031   COMMA           A(1)                  977D
                            VARYING(2)
 *RNF7031   COUNT           I(10,0)               978D
 *RNF7031   FILLER          A(64)                 985D
 *RNF7031   ISFIRST         N(1)                  974D
 *RNF7031   ISLAST          N(1)                  975D
 *RNF7031   ISLIST          N(1)                  973D
 *RNF7031   ISRECURSIVE     N(1)                  976D
 *RNF7031   LENGTH          I(10,0)               979D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     45
 *RNF7031   LISTARR         *(16)                 982D
 *RNF7031   ROOT            *(16)                 971D
 *RNF7031   SIZE            I(10,0)               980D
 *RNF7031   THIS            *(16)                 972D
 *RNF7031 JSON_LAST_CHILD   CONST                 716D
 *RNF7031 JSON_LITERAL      CONST                 396D
 *RNF7031 JSON_LOCATE       *(16)                 468D
                            PROTOTYPE
 *RNF7031 JSON_LOCATEORCREATE...
                            *(16)                 476D
                            PROTOTYPE
 *RNF7031 JSON_LOOKUPVALUE  *(16)                 815D
                            PROTOTYPE
 *RNF7031 JSON_MAPIX        N(1)                 1098D
                            PROTOTYPE
 *RNF7031 JSON_MEMLEAK      N(1)                 1074D
                            PROTOTYPE
 *RNF7031 JSON_MEMSTAT      PROTOTYPE            1078D
 *RNF7031 JSON_MEMUSE       U(20,0)              1082D
                            PROTOTYPE
 *RNF7031 JSON_MERGE        *(16)                 835D
                            PROTOTYPE
 *RNF7031 JSON_MERGEOBJECTS *(16)                 849D
                            PROTOTYPE
 *RNF7031 JSON_MESSAGE      A(1024)               462D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_META         CONST                1148D
 *RNF7031 JSON_MOVE_MODES   CONST                 406D
 *RNF7031 JSON_MOVE_UNLINK  CONST                 779D
 *RNF7031 JSON_MOVEOBJECTINTO...
                            *(16)                 859D
                            PROTOTYPE
 *RNF7031 JSON_NEWARRAY     *(16)                 763D
                            PROTOTYPE
 *RNF7031 JSON_NEWOBJECT    *(16)                 756D
                            PROTOTYPE
 *RNF7031 JSON_NODEADD      *(16)                 726D
                            PROTOTYPE
 *RNF7031 JSON_NODECHECKSUM U(10,0)               751D
                            PROTOTYPE
 *RNF7031 JSON_NODECLONE    *(16)                 720D
                            PROTOTYPE
 *RNF7031 JSON_NODECOPY     PROTOTYPE             705D
 *RNF7031 JSON_NODEDELETE   PROTOTYPE             739D
 *RNF7031 JSON_NODERENAME   N(1)                  515D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     46
                            PROTOTYPE
 *RNF7031 JSON_NODESANITIZE PROTOTYPE             744D
 *RNF7031 JSON_NODETYPE     I(5,0)                634D
                            PROTOTYPE
 *RNF7031 JSON_OBJCOPY      CONST                 399D
 *RNF7031 JSON_OBJECT       CONST                 390D
 *RNF7031 JSON_OBJLINK      CONST                 397D
 *RNF7031 JSON_OBJMOVE      CONST                 401D
 *RNF7031 JSON_OBJREPLACE   CONST                 398D
 *RNF7031 JSON_PARSE        CONST                 412D
 *RNF7031 JSON_PARSEFILE    *(16)                 432D
                            PROTOTYPE
 *RNF7031 JSON_PARSESTRING  *(16)                 440D
                            PROTOTYPE
 *RNF7031 JSON_POINTER_VALUE...
                            CONST                 393D
 *RNF7031 JSON_REPLACE      CONST                 846D
 *RNF7031 JSON_ROOT         CONST                 395D
 *RNF7031 JSON_ROWARRAY     CONST                1146D
 *RNF7031 JSON_SAME_CASE    CONST                 825D
 *RNF7031 JSON_SEGMENTDISPOSE...
                            PROTOTYPE            1092D
 *RNF7031 JSON_SEGMENTSELECTNO...
                            *(16)                1086D
                            PROTOTYPE
 *RNF7031 JSON_SETATTRVALUE PROTOTYPE            1038D
 *RNF7031 JSON_SETBOOL      *(16)                 567D
                            PROTOTYPE
 *RNF7031 JSON_SETCCSID     PROTOTYPE            1430D
 *RNF7031 JSON_SETDEC       *(16)                1438D
                            PROTOTYPE
 *RNF7031 JSON_SETDECPOINT  PROTOTYPE             448D
 *RNF7031 JSON_SETDELIMITERS...
                            PROTOTYPE             379D
 *RNF7031 JSON_SETINT       *(16)                 549D
                            PROTOTYPE
 *RNF7031 JSON_SETITERATOR  DS(145)               988D
                            PROTOTYPE
 *RNF7031 JSON_SETNODEATTRVALUE...
                            PROTOTYPE            1021D
 *RNF7031 JSON_SETNUM       *(16)                 558D
                            PROTOTYPE
 *RNF7031 JSON_SETPTR       *(16)                 576D
                            PROTOTYPE
 *RNF7031 JSON_SETRECURSIVEITERATOR...
                            DS(145)               996D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     47
                            PROTOTYPE
 *RNF7031 JSON_SETSTR       *(16)                 540D
                            PROTOTYPE
 *RNF7031 JSON_SETVALUE     *(16)                 585D
                            PROTOTYPE
 *RNF7031 JSON_SQLCLOSE     PROTOTYPE            1205D
 *RNF7031 JSON_SQLCODE      I(10,0)              1274D
                            PROTOTYPE
 *RNF7031 JSON_SQLCOLUMNS   I(10,0)              1191D
                            PROTOTYPE
 *RNF7031 JSON_SQLCONNECT   *(16)                1264D
                            PROTOTYPE
 *RNF7031 JSON_SQLDISCONNECT...
                            PROTOTYPE            1270D
 *RNF7031 JSON_SQLEXEC      N(1)                 1212D
                            PROTOTYPE
 *RNF7031 JSON_SQLFETCHNEXT *(16)                1184D
                            PROTOTYPE
 *RNF7031 JSON_SQLFETCHRELATIVE...
                            *(16)                1174D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETINSERTID...
                            I(10,0)              1255D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETMETA   *(16)                1259D
                            PROTOTYPE
 *RNF7031 JSON_SQLINSERT    N(1)                 1233D
                            PROTOTYPE
 *RNF7031 JSON_SQLOPEN      *(16)                1165D
                            PROTOTYPE
 *RNF7031 JSON_SQLRESULTROW *(16)                1119D
                            PROTOTYPE
          JSON_SQLRESULTSET *(16)                1128D   1498
                            PROTOTYPE
 *RNF7031 JSON_SQLROWS      I(10,0)              1199D
                            PROTOTYPE
 *RNF7031 JSON_SQLSETOPTIONS...
                            PROTOTYPE            1112D
 *RNF7031 JSON_SQLUPDATE    N(1)                 1221D
                            PROTOTYPE
 *RNF7031 JSON_SQLUPSERT    N(1)                 1243D
                            PROTOTYPE
          JSON_STREAM       *(16)                 935D   1502
                            PROTOTYPE
 *RNF7031 JSON_TOTALROWS    CONST                1153D
 *RNF7031 JSON_TRACESETID   PROTOTYPE            1290D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     48
 *RNF7031 JSON_UNKNOWN      CONST                 389D
 *RNF7031 JSON_UPPERCASE    CONST                1155D
 *RNF7031 JSON_USE_LOCALE   CONST                 812D
 *RNF7031 JSON_VALUE        CONST                 394D
 *RNF7031 JSON_WRITECSVSTMF PROTOTYPE             941D
 *RNF7031 JSON_WRITEJSONSTMF...
                            PROTOTYPE             881D
 *RNF7031 JSON_WRITESTMF    PROTOTYPE            1450D
 *RNF7031 JSON_WRITEXMLSTMF PROTOTYPE             910D
 *RNF7031 JSON_XPATHVALUE   A(32767)             1346D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_XPATHVALUENUM...
                            P(30,15)             1357D
                            PROTOTYPE
          MAIN              PROTOTYPE               9    1474
 *RNF7031 MO_MERGE_MATCH    CONST                 422D
 *RNF7031 MO_MERGE_NEW      CONST                 420D
 *RNF7031 MO_MERGE_REPLACE  CONST                 425D
          MYSERVLET         PROTOTYPE            1481    1487
          PROTOTYPE_ONLY    *(16)                 955     970
 *RNF7031 XML_WRITESTMF     PROTOTYPE            1460D
       Field References for subprocedure MAIN
          Field             Attributes         References (D=Defined M=Modified)
          CONFIG            DS(4166)             1476D   1478M   1479M   1481
            HOST            A(64)                1479
                            VARYING(2)
            PORT            I(10,0)              1478
       Field References for subprocedure MYSERVLET
          Field             Attributes         References (D=Defined M=Modified)
          POUTPUT           *(16)                1494D   1498M   1502    1504
 *RNF7031 REQUEST           DS(560)              1490D
                            BASED(_QRNL_PST+)
          RESPONSE          DS(568)              1491D   1496M   1502
                            BASED(_QRNL_PST+)
            CONTENTTYPE     A(256)               1496
                            VARYING(2)
       Indicator References:
          Indicator                            References (D=Defined M=Modified)
        * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     49
                       E x t e r n a l   R e f e r e n c e s
       Statically bound procedures:
          Procedure                            References
          jx_Has                                  485
          jx_Dump                                 867
          lvpc2lvc                                106
          jx_Error                                456
          jx_Clear                               1064
          jx_Close                               1069
          jx_MapIx                               1098
          il_listen                               264    1481
          jx_IsTrue                               493
          jx_IsNull                               501
          jx_isNode                               509
          jx_Stream                               935    1502
          jx_MemUse                              1082
          jx_Message                              462
          jx_GetNode                              468
          jx_NodeAdd                              726    1375
          jx_ForEach                             1006
          jx_MemLeak                             1074
          jx_MemStat                             1078
          jx_sqlOpen                             1165
          jx_sqlRows                             1199
          jx_sqlExec                             1212
          jx_sqlCode                             1274
          il_addRoute                             341
          jx_NodeCopy                             705    1308    1317
          jx_NewArray                             763
          jx_sqlClose                            1205
          jx_SetCcsid                            1430
          jx_ParseFile                            432
          jx_CopyValue                            694
          jx_NodeClone                            720
          jx_NewObject                            756
          jx_ArrayPush                            769
          jx_ArraySort                            805
          jx_getLength                            829
          jx_NodeMerge                            835
          jx_AsXmlText                            922
          jx_sqlUpdate                           1221
          jx_sqlInsert                           1233
          jx_sqlUpsert                           1243
          il_getContent                           224
          jx_NodeRename                           515
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     50
          jx_GetValueVC                           642    1298    1347
          jx_NodeDelete                           739    1327    1333    1504
          jx_ArraySlice                           793
          jx_AsJsonText                           894    1339
          jx_sqlColumns                          1191
          jx_sqlGetMeta                          1259
          jx_sqlConnect                          1264
          jx_traceSetId                          1290
          il_serveStatic                          316
          jx_ParseString                          440
          jx_SetDecPoint                          448
          jx_GetNodeNext                          523    1388
          jx_GetNodeType                          634    1368
          jx_GetValueNum                          665    1358
          jx_GetValueInt                          674
          jx_ArrayAppend                          783
          jx_lookupValue                          815
          jx_CloneFormat                          873
          jx_SetIterator                          989
          jx_GetAttrNext                         1052
          jx_httpRequest                         1278
          jx_GetNodeChild                         529    1395
          jx_SetStrByName                         540
          jx_SetIntByName                         549
          jx_SetDecByName                         558    1438
          jx_SetPtrByName                         576
          jx_GetStrJoinVC                         653
          jx_NodeSanitize                         744
          jx_NodeCheckSum                         751
          jx_MergeObjects                         849
          jx_NodeMoveInto                         859
          jx_WriteXmlStmf                         910    1460
          jx_AsXmlTextMem                         927
          jx_WriteCsvStmf                         941
          jx_SetAttrValue                        1038
          jx_GetAttrFirst                        1046
          jx_sqlResultRow                        1119
          jx_sqlResultSet                        1128    1500
          jx_sqlFetchNext                        1184
          il_getRequestUrl                        136
          il_responseWrite                        283     303
          jx_GetDelimiters                        376
          jx_GetNodeParent                        535
          jx_SetBoolByName                        567
          jx_GetNodeNameVC                        620    1403
          ILOB_XmlGetValue                        685
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     51
          jx_WriteJsonStmf                        881    1450
          jx_AsJsonTextMem                        900
          jx_GetAttrNameVC                       1058
          jx_sqlSetOptions                       1112
          jx_sqlDisconnect                       1270
          jx_SetDelimiters2                       379
          jx_SetValueByName                       585
          jx_GetNodeValueVC                       597    1410
          jx_GetAttrValueVC                      1031
          jx_SegmentDispose                      1092
          jx_sqlGetInsertId                      1255
          il_getFileMimeType                      238
          jx_GetOrCreateNode                      477
          jx_GetNodeValueNum                      605
          jx_GetNodeValuePtr                      612
          jx_SegmentSelectNo                     1087
          il_getRequestMethod                     119
          il_getRequestHeader                     207
          il_getFileExtension                     252
          jx_SetNodeAttrValue                    1021
          jx_sqlFetchRelative                    1175
          il_getRequestHeaders                    194
          jx_GetNodeNameAsPath                    626
          il_getRequestResource                   151
          il_getRequestProtocol                   181
          jx_GetNodeAttrValueVC                  1012    1419
          il_responseWriteStream                  329    1502
          jx_SetRecursiveIterator                 998
          il_getRequestQueryString                168
       Imported fields:
          Field             Attributes         Defined
          No references in the source.
       Exported fields:
          Field             Attributes         Defined
          No references in the source.
    * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     52
                           M e s s a g e   S u m m a r y
  Msg id  Sv Number Message text
 *RNF7031 00    272 The name or indicator is not referenced.
        * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             ILEASTIC/DEMO03          DKSRV133   10-10-18 22:07:03        Page     53
                             F i n a l   S u m m a r y
   Message Totals:
     Information  (00) . . . . . . . :      272
     Warning      (10) . . . . . . . :        0
     Error        (20) . . . . . . . :        0
     Severe Error (30+)  . . . . . . :        0
     ---------------------------------  -------
     Total . . . . . . . . . . . . . :      272
   Source Totals:
     Records . . . . . . . . . . . . :     1506
     Specifications  . . . . . . . . :      692
     Data records  . . . . . . . . . :        0
     Comments  . . . . . . . . . . . :      635
          * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
 Program DEMO03 placed in library ILEASTIC. 00 highest severity. Created on 10-10-18 at 22:07:03.
           * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
